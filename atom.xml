<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>回忆宫殿</title>
  
  <subtitle>MemoryPalace</subtitle>
  <link href="https://mralridge.github.io/atom.xml" rel="self"/>
  
  <link href="https://mralridge.github.io/"/>
  <updated>2024-07-18T03:53:19.086Z</updated>
  <id>https://mralridge.github.io/</id>
  
  <author>
    <name>F10atingHeart</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>删除有序数组中的重复项-每天1LeetCode</title>
    <link href="https://mralridge.github.io/2024/07/18/%E5%88%A0%E9%99%A4%E6%9C%89%E5%BA%8F%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E9%A1%B9-%E6%AF%8F%E5%A4%A91LeetCode/"/>
    <id>https://mralridge.github.io/2024/07/18/%E5%88%A0%E9%99%A4%E6%9C%89%E5%BA%8F%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E9%A1%B9-%E6%AF%8F%E5%A4%A91LeetCode/</id>
    <published>2024-07-18T03:45:36.000Z</published>
    <updated>2024-07-18T03:53:19.086Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>给你一个 <strong>非严格递增排列</strong> 的数组 <code>nums</code> ，请你 <strong>原地</strong> 删除重复出现的元素，使每个元素 <strong>只出现一次</strong> ，返回删除后数组的新长度。元素的 <strong>相对顺序</strong> 应该保持 <strong>一致</strong> 。然后返回 <code>nums</code> 中唯一元素的个数。</p><p>考虑 <code>nums</code> 的唯一元素的数量为 <code>k</code> ，你需要做以下事情确保你的题解可以被通过：</p><p>更改数组 <code>nums</code> ，使 <code>nums</code> 的前 <code>k</code> 个元素包含唯一元素，并按照它们最初在 <code>nums</code> 中出现的顺序排列。<code>nums</code> 的其余元素与 <code>nums</code> 的大小不重要。<br>返回 <code>k</code> 。<br>判题标准:</p><p>系统会用下面的代码来测试你的题解:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] nums = [...]; <span class="comment">// 输入数组</span></span><br><span class="line"><span class="type">int</span>[] expectedNums = [...]; <span class="comment">// 长度正确的期望答案</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> k = <span class="built_in">removeDuplicates</span>(nums); <span class="comment">// 调用</span></span><br><span class="line"></span><br><span class="line">assert k == expectedNums.length;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; k; i++) &#123;</span><br><span class="line">    assert nums[i] == expectedNums[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果所有断言都通过，那么您的题解将被 通过。</p><p>示例 1：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [1,1,2]</span><br><span class="line">输出：2, nums = [1,2,_]</span><br><span class="line">解释：函数应该返回新的长度 2 ，并且原数组 nums 的前两个元素被修改为 1, 2 。不需要考虑数组中超出新长度后面的元素。</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [0,0,1,1,1,2,2,3,3,4]</span><br><span class="line">输出：5, nums = [0,1,2,3,4]</span><br><span class="line">解释：函数应该返回新的长度 5 ， 并且原数组 nums 的前五个元素被修改为 0, 1, 2, 3, 4 。不需要考虑数组中超出新长度后面的元素。</span><br></pre></td></tr></table></figure><p>提示：</p><ul><li><code>1 &lt;= nums.length &lt;= 3 * 104</code></li><li><code>-104 &lt;= nums[i] &lt;= 104</code></li><li><code>nums</code> 已按 <strong>非严格递增</strong> 排列</li></ul><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>这道题因为我自己试错了半天都没解出来,所以直接看了 Top Voted Solution,才发现我把问题想复杂了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">removeDuplicates</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> n : nums)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!i || n &gt; nums[i<span class="number">-1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                nums[i++] = n;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这段代码主要涉及以下内容:</p><ul><li><code>!i</code>是个语法糖,用来判断<code>i</code>是否为0</li><li><code>i</code> 存储的是<code>nums</code>的索引,相当于修改原向量的部分是从头开始的</li><li>因为<code>nums</code>是 <strong>非严格递增</strong> 排列,所以只用考虑这个数是否比上一个数大</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;题目&quot;&gt;&lt;a href=&quot;#题目&quot; class=&quot;headerlink&quot; title=&quot;题目&quot;&gt;&lt;/a&gt;题目&lt;/h2&gt;&lt;p&gt;给你一个 &lt;strong&gt;非严格递增排列&lt;/strong&gt; 的数组 &lt;code&gt;nums&lt;/code&gt; ，请你 &lt;strong&gt;原地&lt;/st</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>有效的括号-每日1LeetCode</title>
    <link href="https://mralridge.github.io/2024/07/17/%E6%9C%89%E6%95%88%E7%9A%84%E6%8B%AC%E5%8F%B7-%E6%AF%8F%E6%97%A51LeetCode/"/>
    <id>https://mralridge.github.io/2024/07/17/%E6%9C%89%E6%95%88%E7%9A%84%E6%8B%AC%E5%8F%B7-%E6%AF%8F%E6%97%A51LeetCode/</id>
    <published>2024-07-17T07:53:48.000Z</published>
    <updated>2024-07-17T08:08:19.227Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>给定一个只包括 <code>&#39;(&#39;</code>，<code>&#39;)&#39;</code>，<code>&#39;&#123;&#39;</code>，<code>&#39;&#125;&#39;</code>，<code>&#39;[&#39;</code>，<code>&#39;]&#39;</code> 的字符串 <code>s</code> ，判断字符串是否有效。</p><p>有效字符串需满足：</p><ul><li>左括号必须用相同类型的右括号闭合。</li><li>左括号必须以正确的顺序闭合。</li><li>每个右括号都有一个对应的相同类型的左括号。</li></ul><p>示例 1：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s = &quot;()&quot;</span><br><span class="line">输出：true</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s = &quot;()[]&#123;&#125;&quot;</span><br><span class="line">输出：true</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：s = &quot;(]&quot;</span><br><span class="line">输出：false</span><br></pre></td></tr></table></figure><p>提示：</p><ul><li><code>1 &lt;= s.length &lt;= 104</code></li><li><code>s</code> 仅由括号 <code>&#39;()[]&#123;&#125;&#39;</code> 组成</li></ul><h2 id="初步解法"><a href="#初步解法" class="headerlink" title="初步解法"></a>初步解法</h2><p>用栈保存括号左侧,遇到括号右侧比较一下,最后再比较栈是否为空即可。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isValid</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 奇数长度的字符串肯定不符合要求</span></span><br><span class="line">        <span class="keyword">if</span> (s.<span class="built_in">size</span>() % <span class="number">2</span> != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        stack&lt;<span class="type">char</span>&gt; strStack = <span class="built_in">stack</span>&lt;<span class="type">char</span>&gt;();</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (s[i] != <span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] == <span class="string">&#x27;(&#x27;</span> || s[i] == <span class="string">&#x27;&#123;&#x27;</span> || s[i] == <span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                strStack.<span class="built_in">push</span>(s[i]);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">// 堆中没有左符号就出现右符号的也不对</span></span><br><span class="line">                <span class="keyword">if</span> (strStack.<span class="built_in">size</span>() == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ((s[i] == <span class="string">&#x27;)&#x27;</span> &amp;&amp; strStack.<span class="built_in">top</span>() == <span class="string">&#x27;(&#x27;</span>) || (s[i] == <span class="string">&#x27;&#125;&#x27;</span> &amp;&amp; strStack.<span class="built_in">top</span>() == <span class="string">&#x27;&#123;&#x27;</span>) || (s[i] == <span class="string">&#x27;]&#x27;</span> &amp;&amp; strStack.<span class="built_in">top</span>() == <span class="string">&#x27;[&#x27;</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    strStack.<span class="built_in">pop</span>();</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> strStack.<span class="built_in">size</span>() == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="更有效率的写法"><a href="#更有效率的写法" class="headerlink" title="更有效率的写法"></a>更有效率的写法</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isValid</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        stack&lt;<span class="type">char</span>&gt; str = <span class="built_in">stack</span>&lt;<span class="type">char</span>&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> c : s)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="string">&#x27;(&#x27;</span> <span class="keyword">or</span> c == <span class="string">&#x27;&#123;&#x27;</span> <span class="keyword">or</span> c == <span class="string">&#x27;[&#x27;</span>) &#123; str.<span class="built_in">push</span>(c); &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(str.<span class="built_in">empty</span>() <span class="built_in">or</span> (str.<span class="built_in">top</span>() == <span class="string">&#x27;(&#x27;</span> <span class="keyword">and</span> c != <span class="string">&#x27;)&#x27;</span>) <span class="built_in">or</span> (str.<span class="built_in">top</span>() == <span class="string">&#x27;&#123;&#x27;</span> <span class="keyword">and</span> c != <span class="string">&#x27;&#125;&#x27;</span>) <span class="built_in">or</span> (str.<span class="built_in">top</span>() == <span class="string">&#x27;[&#x27;</span> <span class="keyword">and</span> c != <span class="string">&#x27;]&#x27;</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                str.<span class="built_in">pop</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> str.<span class="built_in">empty</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这样做的效率更高,初步推测是用了迭代器,所以就不用每次都判断是不是<code>&#39;\0&#39;</code>,而且整体要判断的条件也少</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;题目&quot;&gt;&lt;a href=&quot;#题目&quot; class=&quot;headerlink&quot; title=&quot;题目&quot;&gt;&lt;/a&gt;题目&lt;/h2&gt;&lt;p&gt;给定一个只包括 &lt;code&gt;&amp;#39;(&amp;#39;&lt;/code&gt;，&lt;code&gt;&amp;#39;)&amp;#39;&lt;/code&gt;，&lt;code&gt;&amp;#39;&amp;</summary>
      
    
    
    
    <category term="每天1LeetCode" scheme="https://mralridge.github.io/categories/%E6%AF%8F%E5%A4%A91LeetCode/"/>
    
    
    <category term="算法" scheme="https://mralridge.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>CMAKE学习笔记</title>
    <link href="https://mralridge.github.io/2024/07/17/CMAKE%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://mralridge.github.io/2024/07/17/CMAKE%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2024-07-17T06:04:44.000Z</published>
    <updated>2024-07-17T07:40:41.492Z</updated>
    
    <content type="html"><![CDATA[<h2 id="什么是CMake"><a href="#什么是CMake" class="headerlink" title="什么是CMake"></a>什么是CMake</h2><p>众所周知,软件是代码经过编译器编译之后的产物,也就是说一个软件要在多个平台运行的话就要能够通过这些平台的编译.而每个平台所使用的编译标准都不一样,就导致如果你要发布一个跨平台的应用,就需要为这些平台都编写独立的文件,这工作量显然是不现实的.</p><p>所以就需要一种无视平台的编译流程,CMake差不多就是为用户根据平台准备编译条件的东西.</p><p>根据我之前的使用经验,使用CMake差不多是下面的流程</p><ul><li>编写CMake配置文件<code>CMakeLists.txt</code>(注意大小写)</li><li>执行命令<code>cmake PATH</code>或者</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;什么是CMake&quot;&gt;&lt;a href=&quot;#什么是CMake&quot; class=&quot;headerlink&quot; title=&quot;什么是CMake&quot;&gt;&lt;/a&gt;什么是CMake&lt;/h2&gt;&lt;p&gt;众所周知,软件是代码经过编译器编译之后的产物,也就是说一个软件要在多个平台运行的话就要能够通</summary>
      
    
    
    
    
    <category term="cmake" scheme="https://mralridge.github.io/tags/cmake/"/>
    
  </entry>
  
  <entry>
    <title>最长公共前缀-每日1LeetCode</title>
    <link href="https://mralridge.github.io/2024/07/16/%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%89%8D%E7%BC%80-%E6%AF%8F%E6%97%A51LeetCode/"/>
    <id>https://mralridge.github.io/2024/07/16/%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%89%8D%E7%BC%80-%E6%AF%8F%E6%97%A51LeetCode/</id>
    <published>2024-07-16T09:54:26.000Z</published>
    <updated>2024-07-16T09:57:18.913Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>编写一个函数来查找字符串数组中的最长公共前缀。</p><p>如果不存在公共前缀，返回空字符串 <code>&quot;&quot;</code>。</p><p>示例 1：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：strs = [&quot;flower&quot;,&quot;flow&quot;,&quot;flight&quot;]</span><br><span class="line">输出：&quot;fl&quot;</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：strs = [&quot;dog&quot;,&quot;racecar&quot;,&quot;car&quot;]</span><br><span class="line">输出：&quot;&quot;</span><br><span class="line">解释：输入不存在公共前缀。</span><br></pre></td></tr></table></figure><p>提示：</p><ul><li>1 &lt;&#x3D; strs.length &lt;&#x3D; 200</li><li>0 &lt;&#x3D; strs[i].length &lt;&#x3D; 200</li><li>strs[i] 仅由小写英文字母组成</li></ul><h2 id="解法"><a href="#解法" class="headerlink" title="解法"></a>解法</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">longestCommonPrefix</span><span class="params">(vector&lt;string&gt;&amp; strs)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> start = <span class="number">0</span>;</span><br><span class="line">        string result = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">char</span> curChar = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; str : strs)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (str[start] == <span class="string">&#x27;\0&#x27;</span>) &#123; <span class="keyword">return</span> result; &#125;</span><br><span class="line">                <span class="keyword">if</span> (curChar == <span class="number">0</span>) &#123; curChar = str[start]; &#125;</span><br><span class="line">                <span class="keyword">if</span> (curChar != str[start])</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> result;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            result.<span class="built_in">append</span>(<span class="number">1</span>, curChar);</span><br><span class="line">            start++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>简单来说就是遍历这几个字符串同一位置的字符，任何字符串遇到<code>&#39;\0&#39;</code>就收手，这里用到了迭代器。</p><p><em>（没想到这道题第一次做就能跑出3ms的时间效率）</em></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;题目&quot;&gt;&lt;a href=&quot;#题目&quot; class=&quot;headerlink&quot; title=&quot;题目&quot;&gt;&lt;/a&gt;题目&lt;/h2&gt;&lt;p&gt;编写一个函数来查找字符串数组中的最长公共前缀。&lt;/p&gt;
&lt;p&gt;如果不存在公共前缀，返回空字符串 &lt;code&gt;&amp;quot;&amp;quot;&lt;/co</summary>
      
    
    
    
    <category term="每天1LeetCode" scheme="https://mralridge.github.io/categories/%E6%AF%8F%E5%A4%A91LeetCode/"/>
    
    
    <category term="算法" scheme="https://mralridge.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>罗马数字转整数-每日1LeetCode</title>
    <link href="https://mralridge.github.io/2024/07/16/%E7%BD%97%E9%A9%AC%E6%95%B0%E5%AD%97%E8%BD%AC%E6%95%B4%E6%95%B0-%E6%AF%8F%E6%97%A51LeetCode/"/>
    <id>https://mralridge.github.io/2024/07/16/%E7%BD%97%E9%A9%AC%E6%95%B0%E5%AD%97%E8%BD%AC%E6%95%B4%E6%95%B0-%E6%AF%8F%E6%97%A51LeetCode/</id>
    <published>2024-07-16T07:39:57.000Z</published>
    <updated>2024-07-16T08:05:29.350Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>罗马数字包含以下七种字符: <code>I</code>，<code>V</code>，<code>X</code>，<code>L</code>，<code>C</code>，<code>D</code> 和 <code>M</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">字符          数值</span><br><span class="line">I             1</span><br><span class="line">V             5</span><br><span class="line">X             10</span><br><span class="line">L             50</span><br><span class="line">C             100</span><br><span class="line">D             500</span><br><span class="line">M             1000</span><br></pre></td></tr></table></figure><p>例如， 罗马数字 <code>2</code> 写做 <code>II</code> ，即为两个并列的 1 。<code>12</code> 写做 <code>XII</code> ，即为 <code>X</code> + <code>II</code> 。 <code>27</code> 写做  <code>XXVII</code>, 即为 <code>XX</code> + <code>V</code> + <code>II</code> 。</p><p>通常情况下，罗马数字中小的数字在大的数字的右边。但也存在特例，例如 4 不写做 <code>IIII</code>，而是 <code>IV</code>。数字 1 在数字 5 的左边，所表示的数等于大数 5 减小数 1 得到的数值 4 。同样地，数字 9 表示为 <code>IX</code>。这个特殊的规则只适用于以下六种情况：</p><ul><li><code>I</code> 可以放在 <code>V</code> (5) 和 <code>X</code> (10) 的左边，来表示 4 和 9。</li><li><code>X</code> 可以放在 <code>L</code> (50) 和 <code>C</code> (100) 的左边，来表示 40 和 90。 </li><li><code>C</code> 可以放在 <code>D</code> (500) 和 <code>M</code> (1000) 的左边，来表示 400 和 900。<br>给定一个罗马数字，将其转换成整数。</li></ul><p>示例 1:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: s = &quot;III&quot;</span><br><span class="line">输出: 3</span><br></pre></td></tr></table></figure><p>示例 2:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: s = &quot;IV&quot;</span><br><span class="line">输出: 4</span><br></pre></td></tr></table></figure><p>示例 3:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: s = &quot;IX&quot;</span><br><span class="line">输出: 9</span><br></pre></td></tr></table></figure><p>示例 4:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入: s = &quot;LVIII&quot;</span><br><span class="line">输出: 58</span><br><span class="line">解释: L = 50, V= 5, III = 3.</span><br></pre></td></tr></table></figure><p>示例 5:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入: s = &quot;MCMXCIV&quot;</span><br><span class="line">输出: 1994</span><br><span class="line">解释: M = 1000, CM = 900, XC = 90, IV = 4.</span><br></pre></td></tr></table></figure><p>提示：</p><ul><li><code>1 &lt;= s.length &lt;= 15</code></li><li><code>s</code> 仅含字符 <code>(&#39;I&#39;, &#39;V&#39;, &#39;X&#39;, &#39;L&#39;, &#39;C&#39;, &#39;D&#39;, &#39;M&#39;)</code></li><li>题目数据保证 <code>s</code> 是一个有效的罗马数字，且表示整数在范围 <code>[1, 3999]</code> 内</li><li>题目所给测试用例皆符合罗马数字书写规则，不会出现跨位等情况。</li><li>IL 和 IM 这样的例子并不符合题目要求，49 应该写作 XLIX，999 应该写作 CMXCIX 。</li><li>关于罗马数字的详尽书写规则，可以参考<a href="https://baike.baidu.com/item/%E7%BD%97%E9%A9%AC%E6%95%B0%E5%AD%97/772296">罗马数字 - 百度百科</a>。</li></ul><h2 id="普通思路"><a href="#普通思路" class="headerlink" title="普通思路"></a>普通思路</h2><p>C++里面string是由字符(char)组成的, 字符直接取值是这个字符的ASCII码，所以判断是直接取单个还是前后连起来的特殊取值就看两数之和就可以了（前提是确保小的数在前面）</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">romanToInt</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> end = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> start = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (start != end)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 先判断两个字符的情况</span></span><br><span class="line">            <span class="type">int</span> add = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (s[start] == <span class="number">73</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">switch</span> (s[start]+s[start+<span class="number">1</span>])</span><br><span class="line">                &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">159</span>:       <span class="comment">// IV</span></span><br><span class="line">                    add = <span class="number">4</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">161</span>:       <span class="comment">// IX</span></span><br><span class="line">                    add = <span class="number">9</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">164</span>:       <span class="comment">// XL</span></span><br><span class="line">                    add = <span class="number">40</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">155</span>:       <span class="comment">// XC</span></span><br><span class="line">                    add = <span class="number">90</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">135</span>:       <span class="comment">//CD</span></span><br><span class="line">                    add = <span class="number">400</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">144</span>:       <span class="comment">//CM</span></span><br><span class="line">                    add = <span class="number">900</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (add != <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    start++;</span><br><span class="line">                    start++;</span><br><span class="line">                    result += add;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s[start] == <span class="number">88</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">switch</span> (s[start]+s[start+<span class="number">1</span>])</span><br><span class="line">                &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">164</span>:       <span class="comment">// XL</span></span><br><span class="line">                    add = <span class="number">40</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">155</span>:       <span class="comment">// XC</span></span><br><span class="line">                    add = <span class="number">90</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (add != <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    start++;</span><br><span class="line">                    start++;</span><br><span class="line">                    result += add;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s[start] == <span class="number">67</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">switch</span> (s[start]+s[start+<span class="number">1</span>])</span><br><span class="line">                &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">135</span>:       <span class="comment">//CD</span></span><br><span class="line">                    add = <span class="number">400</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">144</span>:       <span class="comment">//CM</span></span><br><span class="line">                    add = <span class="number">900</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (add != <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    start++;</span><br><span class="line">                    start++;</span><br><span class="line">                    result += add;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">switch</span> (s[start])</span><br><span class="line">            &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;I&#x27;</span>:</span><br><span class="line">                add = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;V&#x27;</span>:</span><br><span class="line">                add = <span class="number">5</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;X&#x27;</span>:</span><br><span class="line">                add = <span class="number">10</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;L&#x27;</span>:</span><br><span class="line">                add = <span class="number">50</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">                add = <span class="number">100</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">                add = <span class="number">500</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;M&#x27;</span>:</span><br><span class="line">                add = <span class="number">1000</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            start++;</span><br><span class="line">            result+=add;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="进阶解法"><a href="#进阶解法" class="headerlink" title="进阶解法"></a>进阶解法</h2><p>哈希表的特性完美契合这个需求</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">romanToInt</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="type">char</span>, <span class="type">int</span>&gt; map = &#123;&#123;<span class="string">&#x27;M&#x27;</span>, <span class="number">1000</span>&#125;, &#123;<span class="string">&#x27;D&#x27;</span>, <span class="number">500</span>&#125;, &#123;<span class="string">&#x27;C&#x27;</span>, <span class="number">100</span>&#125;, &#123;<span class="string">&#x27;L&#x27;</span>, <span class="number">50</span>&#125;, &#123;<span class="string">&#x27;X&#x27;</span>, <span class="number">10</span>&#125;, &#123;<span class="string">&#x27;V&#x27;</span>, <span class="number">5</span>&#125;, &#123;<span class="string">&#x27;I&#x27;</span>, <span class="number">1</span>&#125;&#125;;</span><br><span class="line">        <span class="type">int</span> result = map[s.<span class="built_in">back</span>()]; <span class="comment">// 从最后一位的数字开始</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>() - <span class="number">1</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 只要输入是合法的，那么特殊写法的最终值就是大值减去小值</span></span><br><span class="line">            <span class="keyword">if</span> (map[s[i]] &lt; map[s[i + <span class="number">1</span>]])</span><br><span class="line">            &#123;</span><br><span class="line">                result -= map[s[i]];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                result += map[s[i]];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><em>(虽然最后我提交的结果空间效率还是没有第一种高，时间效率也没增加多少)</em></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;题目&quot;&gt;&lt;a href=&quot;#题目&quot; class=&quot;headerlink&quot; title=&quot;题目&quot;&gt;&lt;/a&gt;题目&lt;/h2&gt;&lt;p&gt;罗马数字包含以下七种字符: &lt;code&gt;I&lt;/code&gt;，&lt;code&gt;V&lt;/code&gt;，&lt;code&gt;X&lt;/code&gt;，&lt;code&gt;L&lt;/co</summary>
      
    
    
    
    <category term="每天1LeetCode" scheme="https://mralridge.github.io/categories/%E6%AF%8F%E5%A4%A91LeetCode/"/>
    
    
    <category term="算法" scheme="https://mralridge.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>回文数-每天1LeetCode</title>
    <link href="https://mralridge.github.io/2024/07/16/%E5%9B%9E%E6%96%87%E6%95%B0-%E6%AF%8F%E5%A4%A91LeetCode/"/>
    <id>https://mralridge.github.io/2024/07/16/%E5%9B%9E%E6%96%87%E6%95%B0-%E6%AF%8F%E5%A4%A91LeetCode/</id>
    <published>2024-07-16T03:05:16.000Z</published>
    <updated>2024-07-16T03:55:47.568Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>给你一个整数 x ，如果 x 是一个回文整数，返回 true ；否则，返回 false 。</p><p>回文数是指正序（从左向右）和倒序（从右向左）读都是一样的整数。</p><ul><li>例如，121 是回文，而 123 不是。</li></ul><p>示例 1：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：x = 121</span><br><span class="line">输出：true</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：x = -121</span><br><span class="line">输出：false</span><br><span class="line">解释：从左向右读, 为 -121 。 从右向左读, 为 121- 。因此它不是一个回文数。</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：x = 10</span><br><span class="line">输出：false</span><br><span class="line">解释：从右向左读, 为 01 。因此它不是一个回文数。</span><br></pre></td></tr></table></figure><p>提示：</p><ul><li>-231 &lt;&#x3D; x &lt;&#x3D; 231 - 1</li></ul><p>进阶：你能不将整数转为字符串来解决这个问题吗？</p><h2 id="基础解法"><a href="#基础解法" class="headerlink" title="基础解法"></a>基础解法</h2><h3 id="使用索引的解法"><a href="#使用索引的解法" class="headerlink" title="使用索引的解法"></a>使用索引的解法</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPalindrome</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 特定值是回文数</span></span><br><span class="line">        <span class="keyword">if</span> (x &gt;= <span class="number">0</span> &amp;&amp; x &lt; <span class="number">10</span>) &#123; <span class="keyword">return</span> <span class="literal">true</span>; &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 小于10的肯定不是回文数</span></span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span>) &#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 先将x转换为字符串</span></span><br><span class="line">        string str = <span class="built_in">to_string</span>(x);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.<span class="built_in">length</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (str[i] != str[str.<span class="built_in">length</span>() - i - <span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>直接从两边开始比较就好了</p><h3 id="使用指针的解法"><a href="#使用指针的解法" class="headerlink" title="使用指针的解法"></a>使用指针的解法</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPalindrome</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 0-9是回文数而小于0的肯定不是回文数</span></span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span> || (x &gt;= <span class="number">0</span> &amp;&amp; x &lt; <span class="number">10</span>)) &#123; <span class="keyword">return</span> x &gt;= <span class="number">0</span>; &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 先将x转换为字符串</span></span><br><span class="line">        string str = <span class="built_in">to_string</span>(x);</span><br><span class="line">        <span class="type">int</span> left = <span class="number">0</span>, right = str.<span class="built_in">length</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (left &lt; right)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (str[left] != str[right])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            left++;</span><br><span class="line">            right--;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这种解法要比上一种解法快不少,因为经过的判断不是很多</p><h2 id="进阶解法"><a href="#进阶解法" class="headerlink" title="进阶解法"></a>进阶解法</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPalindrome</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span> || (x % <span class="number">10</span> == <span class="number">0</span> &amp;&amp; x != <span class="number">0</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (x &gt; y) &#123;</span><br><span class="line">            y = y * <span class="number">10</span> + x % <span class="number">10</span>;</span><br><span class="line">            x = x / <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (x == y || x == y / <span class="number">10</span>) &#123; <span class="keyword">return</span> <span class="literal">true</span>; &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这种方法是取数字的一半,最后比较这两个一半是否相等,如果感觉不好理解的话可以看下面的表</p><table><thead><tr><th align="center">reversedHalf</th><th align="center">x</th></tr></thead><tbody><tr><td align="center">输入12321的情况</td><td align="center"></td></tr><tr><td align="center">0</td><td align="center">12321</td></tr><tr><td align="center">1</td><td align="center">1232</td></tr><tr><td align="center">12</td><td align="center">123</td></tr><tr><td align="center">123</td><td align="center">12</td></tr><tr><td align="center">输入11的情况</td><td align="center"></td></tr><tr><td align="center">0</td><td align="center">11</td></tr><tr><td align="center">1</td><td align="center">1</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;题目&quot;&gt;&lt;a href=&quot;#题目&quot; class=&quot;headerlink&quot; title=&quot;题目&quot;&gt;&lt;/a&gt;题目&lt;/h2&gt;&lt;p&gt;给你一个整数 x ，如果 x 是一个回文整数，返回 true ；否则，返回 false 。&lt;/p&gt;
&lt;p&gt;回文数是指正序（从左向右）和倒序（</summary>
      
    
    
    
    <category term="每天1LeetCode" scheme="https://mralridge.github.io/categories/%E6%AF%8F%E5%A4%A91LeetCode/"/>
    
    
    <category term="算法" scheme="https://mralridge.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>两数相加-每天1LeetCode</title>
    <link href="https://mralridge.github.io/2024/07/15/%E4%B8%A4%E6%95%B0%E7%9B%B8%E5%8A%A0-%E6%AF%8F%E5%A4%A91LeetCode/"/>
    <id>https://mralridge.github.io/2024/07/15/%E4%B8%A4%E6%95%B0%E7%9B%B8%E5%8A%A0-%E6%AF%8F%E5%A4%A91LeetCode/</id>
    <published>2024-07-15T09:44:23.000Z</published>
    <updated>2024-07-15T09:52:18.017Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>给定一个整数数组 <code>nums</code> 和一个整数目标值 <code>target</code>，请你在该数组中找出 和为目标值 <code>target</code>  的那 两个 整数，并返回它们的数组下标。</p><p>你可以假设每种输入只会对应一个答案。但是，数组中同一个元素在答案里不能重复出现。</p><p>你可以按任意顺序返回答案。</p><p>示例 1：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [2,7,11,15], target = 9</span><br><span class="line">输出：[0,1]</span><br><span class="line">解释：因为 nums[0] + nums[1] == 9 ，返回 [0, 1] 。</span><br></pre></td></tr></table></figure><p>示例 2：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [3,2,4], target = 6</span><br><span class="line">输出：[1,2]</span><br></pre></td></tr></table></figure><p>示例 3：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [3,3], target = 6</span><br><span class="line">输出：[0,1]</span><br></pre></td></tr></table></figure><p>提示：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2 &lt;= nums.length &lt;= 104</span><br><span class="line">-109 &lt;= nums[i] &lt;= 109</span><br><span class="line">-109 &lt;= target &lt;= 109</span><br><span class="line">只会存在一个有效答案</span><br></pre></td></tr></table></figure><p>进阶：你可以想出一个时间复杂度小于 <code>O(n2)</code> 的算法吗？</p><h2 id="解法一"><a href="#解法一" class="headerlink" title="解法一"></a>解法一</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">twoSum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">result</span><span class="params">(<span class="number">2</span>, <span class="number">-1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> offset = target - nums[i];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = i+<span class="number">1</span>; j &lt; nums.<span class="built_in">size</span>(); j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (nums[j] == offset)</span><br><span class="line">                &#123;</span><br><span class="line">                    result[<span class="number">0</span>] = i;</span><br><span class="line">                    result[<span class="number">1</span>] = j;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这种解法比较直接，双循环比较，因为觉得比较的时候加起来比较麻烦，所以直接比较差值了</p><h2 id="解法二"><a href="#解法二" class="headerlink" title="解法二"></a>解法二</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">twoSum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> target)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; numMap;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; result;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> offset = target - nums[i];</span><br><span class="line">            <span class="keyword">auto</span> it = numMap.<span class="built_in">find</span>(offset);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (it != numMap.<span class="built_in">end</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                result.<span class="built_in">push_back</span>(it-&gt;second);</span><br><span class="line">                result.<span class="built_in">push_back</span>(i);</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">            numMap[nums[i]] = i; </span><br><span class="line">        &#125;</span><br><span class="line">        result[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">        result[<span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>运用哈希表，将比较过的数和它的索引都放到哈希表中，在遍历的时候直接查找哈希表中有没有符合条件的数就好了</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;题目&quot;&gt;&lt;a href=&quot;#题目&quot; class=&quot;headerlink&quot; title=&quot;题目&quot;&gt;&lt;/a&gt;题目&lt;/h2&gt;&lt;p&gt;给定一个整数数组 &lt;code&gt;nums&lt;/code&gt; 和一个整数目标值 &lt;code&gt;target&lt;/code&gt;，请你在该数组中找出 和为目标</summary>
      
    
    
    
    <category term="每天1LeetCode" scheme="https://mralridge.github.io/categories/%E6%AF%8F%E5%A4%A91LeetCode/"/>
    
    
    <category term="算法" scheme="https://mralridge.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>年轻人到底要怎样活着</title>
    <link href="https://mralridge.github.io/2024/07/12/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E5%88%B0%E5%BA%95%E8%A6%81%E6%80%8E%E6%A0%B7%E6%B4%BB%E7%9D%80/"/>
    <id>https://mralridge.github.io/2024/07/12/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E5%88%B0%E5%BA%95%E8%A6%81%E6%80%8E%E6%A0%B7%E6%B4%BB%E7%9D%80/</id>
    <published>2024-07-12T07:38:56.000Z</published>
    <updated>2024-07-12T08:01:56.264Z</updated>
    
    <content type="html"><![CDATA[<p>从小到大我只感觉一种反差感,</p><p>对现实和梦想的反差.</p><p>我从小在小县城里长大,数学成绩一直不好.但是支撑我最初走进现在的游戏行业的是梦想,支撑我就算不想学数学,为了能够看懂代码也要学好数学.</p><p>就这样,我从一个注定要上大专的人努力成了能够上得起本科的人.</p><p>在大学之前我一直梦想着能够靠着努力出人头地,这么长时间以来我一直在学着正常人所不想学的东西,想要靠着不一样的东西出众.</p><p>这也是为什么高中的时候别人在想怎么玩,我在独自抱着&lt;C语言从入门到精通&gt;啃,事实证明这段经历也造就了我异于常人的性格.</p><p>上了大学以后,最开始我也在随波逐流,但是自从想起小时候的梦想是做出一款让大众认可的游戏,我又在努力的学游戏开发的知识,所以又开始了那种异于常人的生活.</p><p>然而现在毕业之后,我却感到迷茫.</p><p>因为家里的变故,我不得不面对现实.</p><p>现实是什么?现实就是作为一个山东人,我要承担起家庭责任,要赶快买房买车,接着结婚生孩子.</p><p>但是对我来说,这就是桎梏.</p><p>我之前所作的努力,将近10年的努力,如果就一辈子活在小县城里,是不是等于我的这些时间与精力就都浪费了呢?</p><p>而且认识的同学,朋友都去了大城市发展,也都过上了自己的生活,唯独我还在原地踏步,仿佛什么都没有做到还丢失了一些东西.</p><p>我承认现状是有我自己的原因,我也犯过很多的错.</p><p>但是我真的不想接受这个现实,自己努力的结果不被家里人肯定,甚至还没毕业就要背上房贷,给自己买房子.</p><p>本质上来说这是家里面为了我好</p><p>可,这不就是一种强买强卖吗?</p><p>在踏入社会之前,梦想着自己要出人头地,就努力撑过了自己不愿意经历的事.到头来发现你所做的一切都不被肯定,甚至家里人要你去接受那一眼看得到头的未来.</p><p>如果我未曾见过太阳,就不会渴求阳光.</p><p>我凭着热血撑到现在,我就要靠着一腔热血活到我梦想的地方去.</p><p>如果现在放弃就此认命的话,那我这一辈子可太不值了.</p><p>没有人能够剥夺我享受的权力,也没有人能够剥夺我受难的权利.无论遇到的事情是好是坏,它们都是我人生的一部分.</p><p>如果因为自己吃过苦就不让下一代去接触,那不就是变相的剥夺人生吗?</p><p>我一直在否定自己,也一直在否定环境.</p><p>因为我不知道造成今天处境的根本原因到底是我自己还是环境的原因.</p><p>真是个两难的选择.</p><p>选择接受现实,就代表着失去自己,那样的人生还算是自己的人生吗?</p><p>如果继续去追逐梦想,那无论结果,现在所做的一切努力与丢掉的东西还值得吗?</p><p>别人的世界都在过着自己想要的生活,或者是向着那个地方努力.</p><p>而我现在眼前的只有现实,要追梦就要抛弃现实,就好像我活该的一样.</p><p>我应该相信的是哪一边?</p><p>没有人能给出答案.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;从小到大我只感觉一种反差感,&lt;/p&gt;
&lt;p&gt;对现实和梦想的反差.&lt;/p&gt;
&lt;p&gt;我从小在小县城里长大,数学成绩一直不好.但是支撑我最初走进现在的游戏行业的是梦想,支撑我就算不想学数学,为了能够看懂代码也要学好数学.&lt;/p&gt;
&lt;p&gt;就这样,我从一个注定要上大专的人努力成了能够</summary>
      
    
    
    
    
    <category term="胡思乱想" scheme="https://mralridge.github.io/tags/%E8%83%A1%E6%80%9D%E4%B9%B1%E6%83%B3/"/>
    
    <category term="胡言乱语" scheme="https://mralridge.github.io/tags/%E8%83%A1%E8%A8%80%E4%B9%B1%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title>解决通义灵码抽风显示无权限的问题</title>
    <link href="https://mralridge.github.io/2024/07/08/%E8%A7%A3%E5%86%B3%E9%80%9A%E4%B9%89%E7%81%B5%E7%A0%81%E6%8A%BD%E9%A3%8E%E6%98%BE%E7%A4%BA%E6%97%A0%E6%9D%83%E9%99%90%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>https://mralridge.github.io/2024/07/08/%E8%A7%A3%E5%86%B3%E9%80%9A%E4%B9%89%E7%81%B5%E7%A0%81%E6%8A%BD%E9%A3%8E%E6%98%BE%E7%A4%BA%E6%97%A0%E6%9D%83%E9%99%90%E7%9A%84%E9%97%AE%E9%A2%98/</id>
    <published>2024-07-08T01:45:40.000Z</published>
    <updated>2024-07-08T01:52:09.213Z</updated>
    
    <content type="html"><![CDATA[<h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>由于公司不方便科学上网,所以一直没用copilot,而用的是阿里的通义灵码,截止到目前(<code>2024/7/8</code>)还是限时免费,(虽然说距离我开始用的时候已经过去将近一年了).</p><p>但是今天在打开vscode的时候发现通义灵码直接给提示<code>无权限</code>了,尝试退出后登录无果,显示通义灵码域名无法解析.</p><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>打开任务管理器,杀掉<code>Lingma.exe</code>进程,之后关闭你的IDE（无论是VsCode还是Idea）,前往<code>C:\Users\你目前使用的用户</code>删除掉<code>.Lingma</code>这一整个目录，之后重启IDE登录即可</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;问题描述&quot;&gt;&lt;a href=&quot;#问题描述&quot; class=&quot;headerlink&quot; title=&quot;问题描述&quot;&gt;&lt;/a&gt;问题描述&lt;/h2&gt;&lt;p&gt;由于公司不方便科学上网,所以一直没用copilot,而用的是阿里的通义灵码,截止到目前(&lt;code&gt;2024/7/8&lt;/co</summary>
      
    
    
    
    <category term="赛博神医" scheme="https://mralridge.github.io/categories/%E8%B5%9B%E5%8D%9A%E7%A5%9E%E5%8C%BB/"/>
    
    
    <category term="IDE" scheme="https://mralridge.github.io/tags/IDE/"/>
    
    <category term="工作经验" scheme="https://mralridge.github.io/tags/%E5%B7%A5%E4%BD%9C%E7%BB%8F%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>利用Python来将抽象的染色方案表转成人能看懂的颜色</title>
    <link href="https://mralridge.github.io/2024/07/02/%E5%88%A9%E7%94%A8Python%E6%9D%A5%E5%B0%86%E6%8A%BD%E8%B1%A1%E7%9A%84%E6%9F%93%E8%89%B2%E6%96%B9%E6%A1%88%E8%A1%A8%E8%BD%AC%E6%88%90%E4%BA%BA%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E9%A2%9C%E8%89%B2/"/>
    <id>https://mralridge.github.io/2024/07/02/%E5%88%A9%E7%94%A8Python%E6%9D%A5%E5%B0%86%E6%8A%BD%E8%B1%A1%E7%9A%84%E6%9F%93%E8%89%B2%E6%96%B9%E6%A1%88%E8%A1%A8%E8%BD%AC%E6%88%90%E4%BA%BA%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84%E9%A2%9C%E8%89%B2/</id>
    <published>2024-07-02T08:11:04.000Z</published>
    <updated>2024-07-10T07:42:33.849Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0-前言"><a href="#0-前言" class="headerlink" title="0&#x2F;前言"></a>0&#x2F;前言</h1><p>工作中遇到了要更改配色方案的需求,然而目前的项目所有的配色是写在一个xml表里面的,大致结构是这样的:</p><blockquote><table><thead><tr><th align="center">ID</th><th align="center">IsFillPart1</th><th align="center">IsAddColorFirst1</th><th align="center">ColorAddFirst1</th><th align="center">HOffset1</th><th align="center">SOffset1</th><th align="center">VOffset1</th><th align="center">IsFillPart2</th><th align="center">IsAddColorFirst2</th><th align="center">ColorAddFirst2</th><th align="center">HOffset2</th><th align="center">SOffset2</th><th align="center">VOffset2</th><th align="center">IsFillPart3</th><th align="center">IsAddColorFirst3</th><th align="center">ColorAddFirst3</th><th align="center">HOffset3</th><th align="center">SOffset3</th><th align="center">VOffset3</th><th align="center">IsFillPart4</th><th align="center">IsAddColorFirst4</th><th align="center">ColorAddFirst4</th><th align="center">HOffset4</th><th align="center">SOffset4</th><th align="center">VOffset4</th><th align="center">IsFillPart5</th><th align="center">IsAddColorFirst5</th><th align="center">ColorAddFirst5</th><th align="center">HOffset5</th><th align="center">SOffset5</th><th align="center">VOffset5</th></tr></thead><tbody><tr><td align="center">1601</td><td align="center">False</td><td align="center">False</td><td align="center">0,0,0,0</td><td align="center">0.56</td><td align="center">0.35</td><td align="center">0.24</td><td align="center">False</td><td align="center">False</td><td align="center">0,0,0,0</td><td align="center">0.57</td><td align="center">0.2</td><td align="center">0.26</td><td align="center">False</td><td align="center">False</td><td align="center">0,0,0,0</td><td align="center">0.63</td><td align="center">0.09</td><td align="center">0.14</td><td align="center">False</td><td align="center">False</td><td align="center">0,0,0,0</td><td align="center">0.54</td><td align="center">-0.1</td><td align="center">0.02</td><td align="center">False</td><td align="center">False</td><td align="center">0,0,0,0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">1603</td><td align="center">True</td><td align="center">False</td><td align="center">0,0,0,0</td><td align="center">0.81</td><td align="center">0.46</td><td align="center">0.15</td><td align="center">False</td><td align="center">False</td><td align="center">0,0,0,0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">False</td><td align="center">False</td><td align="center">0,0,0,0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">False</td><td align="center">False</td><td align="center">0,0,0,0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td><td align="center">False</td><td align="center">False</td><td align="center">0,0,0,0</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr></tbody></table></blockquote><p>说句实在话，我看见这一堆堆的数字就头疼，更何况这些数据没有代码高亮来划分区域，所以我就在想，既然是表示颜色的数据，为什么不干脆直接把rgb数值什么的转换成颜色展示出来呢？</p><h1 id="1-看懂表"><a href="#1-看懂表" class="headerlink" title="1&#x2F;看懂表"></a>1&#x2F;看懂表</h1><p>这些表都是人写出来的，所以只要你是个人就可以读懂。</p><p>别看这个表有这么一大堆字段，仔细看的话其实可以分类成下面的结构：</p><ul><li><code>ID</code> 顾名思义，表示染色方案的id</li><li><code>IsFillPartX</code> 这里对应的是个布尔值，所以我觉得应该是角色身上编号为X的部位是否参与染色</li><li><code>IsAddColorFirstX</code> 这里对应的也是个布尔值，初步推测是代表染色方案的颜色是否叠加在原有颜色上，不然就直接覆盖了。</li><li><code>ColorAddFirstX</code> 这里对应的是颜色，格式为<code>R,G,B,A</code>，其中<code>R,G,B</code>代表红绿蓝，<code>A</code>代表透明度，但是这里的取值范围取值范围很奇怪，是<code>0-1</code>，正常的RGB取值是在<code>0-255</code>的,所以这里在后面用到的时候肯定要处理一下。</li><li><code>HOffsetX</code>,<code>SOffsetX</code>,<code>VOffsetX</code> Offset的意思是偏移，去掉Offset之后这里的意义就很明显了，就是另一种颜色格式<code>HSV</code>(色相、饱和度、亮度)的偏移量</li></ul><h1 id="2-做计划"><a href="#2-做计划" class="headerlink" title="2&#x2F;做计划"></a>2&#x2F;做计划</h1><p>现在我们看懂这个表是什么意思之后，其实这个染色方案表是怎样运行的就能了解个大差不离了。那么我们应该怎么把它转成我们能看懂的具体颜色呢?我的想法是这样的</p><p>既然他有HSV偏移这个概念，那就是说颜色的混合过程就是先将RGB颜色转换成HSV颜色，之后再将HSV偏移量加上，最后可以转回RGB颜色。</p><h1 id="3-具体代码实现"><a href="#3-具体代码实现" class="headerlink" title="3&#x2F;具体代码实现"></a>3&#x2F;具体代码实现</h1><p>我的想法是先将数据整理一下从原来的表中拿出来，只保留我们需要的字段，之后再根据我们需要的字段处理成最后的颜色。</p><p>对于拿出数据这一块，我是用下面的代码实现的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> colorsys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">value2rgb</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    temp = <span class="built_in">str</span>.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">    temp[<span class="number">0</span>] = <span class="built_in">int</span>(<span class="built_in">float</span>(temp[<span class="number">0</span>])*<span class="number">255</span>)</span><br><span class="line">    temp[<span class="number">1</span>] = <span class="built_in">int</span>(<span class="built_in">float</span>(temp[<span class="number">1</span>])*<span class="number">255</span>)</span><br><span class="line">    temp[<span class="number">2</span>] = <span class="built_in">int</span>(<span class="built_in">float</span>(temp[<span class="number">2</span>])*<span class="number">255</span>)</span><br><span class="line">    temp[<span class="number">3</span>] = <span class="built_in">int</span>(<span class="built_in">float</span>(temp[<span class="number">3</span>])*<span class="number">255</span>)</span><br><span class="line">    <span class="keyword">return</span> temp</span><br><span class="line"></span><br><span class="line">path = <span class="string">r&quot;你的表路径&quot;</span></span><br><span class="line">os.chdir(path)</span><br><span class="line"></span><br><span class="line">workbook = openpyxl.load_workbook(<span class="string">&quot;rawdata.xlsx&quot;</span>)</span><br><span class="line">sheet = workbook[<span class="string">&#x27;Sheet1&#x27;</span>]</span><br><span class="line"></span><br><span class="line">sheetRange = sheet.dimensions</span><br><span class="line"></span><br><span class="line">ids = sheet[<span class="string">&quot;A&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">len</span>(ids)):</span><br><span class="line">    curId = sheet.cell(index,<span class="number">1</span>).value</span><br><span class="line">    content1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    content2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    content3 = <span class="string">&quot;&quot;</span></span><br><span class="line">    content4 = <span class="string">&quot;&quot;</span></span><br><span class="line">    content5 = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 部位1</span></span><br><span class="line">    <span class="keyword">if</span>(sheet.cell(index,<span class="number">2</span>).value != <span class="string">&quot;False&quot;</span>):</span><br><span class="line">        rgbValue = value2rgb(sheet.cell(index,<span class="number">4</span>).value)</span><br><span class="line">        hsvValue = <span class="built_in">list</span>(colorsys.rgb_to_hsv(rgbValue[<span class="number">0</span>], rgbValue[<span class="number">1</span>], rgbValue[<span class="number">2</span>]))</span><br><span class="line">        Hoffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">5</span>).value)</span><br><span class="line">        Soffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">6</span>).value)</span><br><span class="line">        Voffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">7</span>).value)</span><br><span class="line">        <span class="comment"># 把偏移加上</span></span><br><span class="line">        hsvValue[<span class="number">0</span>] += Hoffset</span><br><span class="line">        hsvValue[<span class="number">1</span>] += Soffset</span><br><span class="line">        hsvValue[<span class="number">2</span>] += Voffset</span><br><span class="line">        rgbValue = colorsys.hsv_to_rgb(hsvValue[<span class="number">0</span>], hsvValue[<span class="number">1</span>], hsvValue[<span class="number">2</span>])</span><br><span class="line">        content1 = <span class="string">&quot;%d %d %d&quot;</span>%(rgbValue[<span class="number">0</span>],rgbValue[<span class="number">1</span>],rgbValue[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        content1 = <span class="string">&quot;None&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 部位2</span></span><br><span class="line">    <span class="keyword">if</span>(sheet.cell(index,<span class="number">8</span>).value != <span class="string">&quot;False&quot;</span>):</span><br><span class="line">        rgbValue = value2rgb(sheet.cell(index,<span class="number">10</span>).value)</span><br><span class="line">        hsvValue = <span class="built_in">list</span>(colorsys.rgb_to_hsv(rgbValue[<span class="number">0</span>], rgbValue[<span class="number">1</span>], rgbValue[<span class="number">2</span>]))</span><br><span class="line">        Hoffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">11</span>).value)</span><br><span class="line">        Soffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">12</span>).value)</span><br><span class="line">        Voffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">13</span>).value)</span><br><span class="line">        <span class="comment"># 把偏移加上</span></span><br><span class="line">        hsvValue[<span class="number">0</span>] += Hoffset</span><br><span class="line">        hsvValue[<span class="number">1</span>] += Soffset</span><br><span class="line">        hsvValue[<span class="number">2</span>] += Voffset</span><br><span class="line">        rgbValue = colorsys.hsv_to_rgb(hsvValue[<span class="number">0</span>], hsvValue[<span class="number">1</span>], hsvValue[<span class="number">2</span>])</span><br><span class="line">        content2 = <span class="string">&quot;%d %d %d&quot;</span>%(rgbValue[<span class="number">0</span>],rgbValue[<span class="number">1</span>],rgbValue[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        content2 = <span class="string">&quot;None&quot;</span></span><br><span class="line">    <span class="comment"># 部位3</span></span><br><span class="line">    <span class="keyword">if</span>(sheet.cell(index,<span class="number">14</span>).value != <span class="string">&quot;False&quot;</span>):</span><br><span class="line">        rgbValue = value2rgb(sheet.cell(index,<span class="number">16</span>).value)</span><br><span class="line">        hsvValue = <span class="built_in">list</span>(colorsys.rgb_to_hsv(rgbValue[<span class="number">0</span>], rgbValue[<span class="number">1</span>], rgbValue[<span class="number">2</span>]))</span><br><span class="line">        Hoffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">17</span>).value)</span><br><span class="line">        Soffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">18</span>).value)</span><br><span class="line">        Voffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">19</span>).value)</span><br><span class="line">        <span class="comment"># 把偏移加上</span></span><br><span class="line">        hsvValue[<span class="number">0</span>] += Hoffset</span><br><span class="line">        hsvValue[<span class="number">1</span>] += Soffset</span><br><span class="line">        hsvValue[<span class="number">2</span>] += Voffset</span><br><span class="line">        rgbValue = colorsys.hsv_to_rgb(hsvValue[<span class="number">0</span>], hsvValue[<span class="number">1</span>], hsvValue[<span class="number">2</span>])</span><br><span class="line">        content3 = <span class="string">&quot;%d %d %d&quot;</span>%(rgbValue[<span class="number">0</span>],rgbValue[<span class="number">1</span>],rgbValue[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        content3 = <span class="string">&quot;None&quot;</span></span><br><span class="line">    <span class="comment"># 部位4</span></span><br><span class="line">    <span class="keyword">if</span>(sheet.cell(index,<span class="number">20</span>).value != <span class="string">&quot;False&quot;</span>):</span><br><span class="line">        rgbValue = value2rgb(sheet.cell(index,<span class="number">22</span>).value)</span><br><span class="line">        hsvValue = <span class="built_in">list</span>(colorsys.rgb_to_hsv(rgbValue[<span class="number">0</span>], rgbValue[<span class="number">1</span>], rgbValue[<span class="number">2</span>]))</span><br><span class="line">        Hoffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">23</span>).value)</span><br><span class="line">        Soffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">24</span>).value)</span><br><span class="line">        Voffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">25</span>).value)</span><br><span class="line">        <span class="comment"># 把偏移加上</span></span><br><span class="line">        hsvValue[<span class="number">0</span>] += Hoffset</span><br><span class="line">        hsvValue[<span class="number">1</span>] += Soffset</span><br><span class="line">        hsvValue[<span class="number">2</span>] += Voffset</span><br><span class="line">        rgbValue = colorsys.hsv_to_rgb(hsvValue[<span class="number">0</span>], hsvValue[<span class="number">1</span>], hsvValue[<span class="number">2</span>])</span><br><span class="line">        content4 = <span class="string">&quot;%d %d %d&quot;</span>%(rgbValue[<span class="number">0</span>],rgbValue[<span class="number">1</span>],rgbValue[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        content4 = <span class="string">&quot;None&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 部位5</span></span><br><span class="line">    <span class="keyword">if</span>(sheet.cell(index,<span class="number">26</span>).value != <span class="string">&quot;False&quot;</span>):</span><br><span class="line">        rgbValue = value2rgb(sheet.cell(index,<span class="number">28</span>).value)</span><br><span class="line">        hsvValue = <span class="built_in">list</span>(colorsys.rgb_to_hsv(rgbValue[<span class="number">0</span>], rgbValue[<span class="number">1</span>], rgbValue[<span class="number">2</span>]))</span><br><span class="line">        Hoffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">29</span>).value)</span><br><span class="line">        Soffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">30</span>).value)</span><br><span class="line">        Voffset = <span class="built_in">float</span>(sheet.cell(index,<span class="number">31</span>).value)</span><br><span class="line">        <span class="comment"># 把偏移加上</span></span><br><span class="line">        hsvValue[<span class="number">0</span>] += Hoffset</span><br><span class="line">        hsvValue[<span class="number">1</span>] += Soffset</span><br><span class="line">        hsvValue[<span class="number">2</span>] += Voffset</span><br><span class="line">        rgbValue = colorsys.hsv_to_rgb(hsvValue[<span class="number">0</span>], hsvValue[<span class="number">1</span>], hsvValue[<span class="number">2</span>])</span><br><span class="line">        content5 = <span class="string">&quot;%d %d %d&quot;</span>%(rgbValue[<span class="number">0</span>],rgbValue[<span class="number">1</span>],rgbValue[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        content5 = <span class="string">&quot;None&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(curId)+<span class="string">&#x27;^&#x27;</span>+content1+<span class="string">&#x27;^&#x27;</span>+content2+<span class="string">&#x27;^&#x27;</span>+content3+<span class="string">&#x27;^&#x27;</span>+content4+<span class="string">&#x27;^&#x27;</span>+content5)</span><br></pre></td></tr></table></figure><p>一上来就看这么一大坨代码确实很吓人，我们不妨先做一下准备工作</p><h2 id="3-1-前置知识"><a href="#3-1-前置知识" class="headerlink" title="3.1&#x2F;前置知识"></a>3.1&#x2F;前置知识</h2><h3 id="3-1-1-openpyxl模块"><a href="#3-1-1-openpyxl模块" class="headerlink" title="3.1.1&#x2F;openpyxl模块"></a>3.1.1&#x2F;openpyxl模块</h3><p>由于python原生不支持直接操作excel文档,所有就要用到这个模块.建议执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install openpyxl</span><br></pre></td></tr></table></figure><p>确保这个模块存在</p><h3 id="3-1-2-colorsys模块"><a href="#3-1-2-colorsys模块" class="headerlink" title="3.1.2&#x2F;colorsys模块"></a>3.1.2&#x2F;colorsys模块</h3><p>这个模块简而言之就是用来实现颜色格式转换的,rgb转hsv然后再转回来之类的,这好像是一个Python内置的模块.</p><h2 id="3-2-具体代码实现"><a href="#3-2-具体代码实现" class="headerlink" title="3.2&#x2F;具体代码实现"></a>3.2&#x2F;具体代码实现</h2><h3 id="3-2-1-打开你的表"><a href="#3-2-1-打开你的表" class="headerlink" title="3.2.1&#x2F;打开你的表"></a>3.2.1&#x2F;打开你的表</h3>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;0-前言&quot;&gt;&lt;a href=&quot;#0-前言&quot; class=&quot;headerlink&quot; title=&quot;0&amp;#x2F;前言&quot;&gt;&lt;/a&gt;0&amp;#x2F;前言&lt;/h1&gt;&lt;p&gt;工作中遇到了要更改配色方案的需求,然而目前的项目所有的配色是写在一个xml表里面的,大致结构是这样的:&lt;</summary>
      
    
    
    
    <category term="工作经验" scheme="https://mralridge.github.io/categories/%E5%B7%A5%E4%BD%9C%E7%BB%8F%E9%AA%8C/"/>
    
    
    <category term="Python" scheme="https://mralridge.github.io/tags/Python/"/>
    
    <category term="基础知识" scheme="https://mralridge.github.io/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>在Lua中实现面向对象</title>
    <link href="https://mralridge.github.io/2024/07/01/%E5%9C%A8Lua%E4%B8%AD%E5%AE%9E%E7%8E%B0%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
    <id>https://mralridge.github.io/2024/07/01/%E5%9C%A8Lua%E4%B8%AD%E5%AE%9E%E7%8E%B0%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</id>
    <published>2024-07-01T07:56:41.000Z</published>
    <updated>2024-07-01T08:50:20.804Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0-前言"><a href="#0-前言" class="headerlink" title="0&#x2F;前言"></a>0&#x2F;前言</h1><p>可能这就是报应吧，刚开始工作的时候没好好学Lua，平常就是把它当成了python这样的其他脚本语言来用，一直没太仔细研究。到现在要做一些比较复杂的逻辑如果还是用之前那种面向过程的思想就会很受罪，所以这篇post来记录下Lua中如何实现面向对象</p><h1 id="1-面向对象的基础概念"><a href="#1-面向对象的基础概念" class="headerlink" title="1&#x2F;面向对象的基础概念"></a>1&#x2F;面向对象的基础概念</h1><p>学过面向对象语言的肯定都很清楚，面向对象语言有以下几大概念：</p><ul><li>对象(Object)</li><li>类(Class)</li><li>封装(Encapsulation)</li><li>继承(Inheritance)</li><li>多态(Polymorphism)</li></ul><p>虽然lua本身没有这样的概念，但是好在它的特性比较好用且自由，我们就利用这些特性来实现</p><h2 id="1-1-对象-Object"><a href="#1-1-对象-Object" class="headerlink" title="1.1&#x2F;对象(Object)"></a>1.1&#x2F;对象(Object)</h2><p>众所周知Lua的数据结构基本上就只有表(table)，在实际使用体验上来说，这是一把双刃剑</p><p>坏处是涉及到一些比较复杂的数据结构，要手搓的东西就比较多</p><p>好处是简单易用，基础的数据结构本质上都大差不差，直接拉一个<code>&#123;&#125;</code>出来就都能搞定。得益于表里面几乎什么东西都能放的特性，我们对表的扩展可做的事情就太多了</p><p><code>对象</code>包含<code>属性</code>与<code>方法</code></p><p>那么来到Lua，用表的话与之对应的就是<code>键值对</code>和<code>作为表的函数值</code></p><div class="note info flat"><p>现在看来这个解释有点抽象，但是看完后面的说明与代码你就能明白了</p></div><h2 id="1-2-类-Class"><a href="#1-2-类-Class" class="headerlink" title="1.2&#x2F;类(Class)"></a>1.2&#x2F;类(Class)</h2><p>面向对象里面的<code>类</code>本质上其实就是一种抽象的<code>工厂模式</code>,不妨回忆一下，类的构造函数是不是就是工厂生产产品的过程呢？</p><p>所以我们在Lua中实现类的方式就是写一个工厂函数，生产出符合类这一概念的表，再通过别的方式把这个表转化成实例</p><h2 id="1-3-封装-Encapsulation"><a href="#1-3-封装-Encapsulation" class="headerlink" title="1.3&#x2F;封装(Encapsulation)"></a>1.3&#x2F;封装(Encapsulation)</h2><p>封装可以通过元表中的<code>__index</code>和<code>__newindex</code>元方法来实现。<code>__index</code>用于访问未找到的表成员时的回溯操作，可以用来控制对私有成员的访问；而<code>__newindex</code>可以在尝试修改未定义的表成员时触发，用来限制或记录对属性的修改。</p><h2 id="1-4-继承-Inheritance"><a href="#1-4-继承-Inheritance" class="headerlink" title="1.4&#x2F;继承(Inheritance)"></a>1.4&#x2F;继承(Inheritance)</h2><p>继承可以通过让子类的元表的<code>__index</code>指向父类来实现。这样，当在子类实例中查找一个方法或属性未果时，会继续在父类中查找。仔细一想好像整个继承的概念就和<code>__index</code>做的事情很像.</p><h2 id="1-5-多态-Polymorphism"><a href="#1-5-多态-Polymorphism" class="headerlink" title="1.5&#x2F;多态(Polymorphism)"></a>1.5&#x2F;多态(Polymorphism)</h2><p>多态主要通过方法重写来实现。子类可以定义与父类同名的方法，覆盖父类的行为。此外，Lua的动态特性自然支持鸭子类型，即只要对象提供了所需的方法，就可以被正确调用，无论对象属于哪个类。</p><blockquote><p>在程序设计中，鸭子类型（英语：duck typing）是动态类型的一种风格。在这种风格中，一个对象有效的语义，不是由继承自特定的类或实现特定的接口，而是由”当前方法和属性的集合”决定。这个概念的名字来源于由James Whitcomb Riley提出的鸭子测试，“鸭子测试”可以这样表述：</p><p>“当看到一只鸟走起来像鸭子、游泳起来像鸭子、叫起来也像鸭子，那么这只鸟就可以被称为鸭子。”</p><p>在鸭子类型中，关注点在于对象的行为，能作什么；而不是关注对象所属的类型。例如，在不使用鸭子类型的语言中，我们可以编写一个函数，它接受一个类型为”鸭子”的对象，并调用它的”走”和”叫”方法。在使用鸭子类型的语言中，这样的一个函数可以接受一个任意类型的对象，并调用它的”走”和”叫”方法。如果这些需要被调用的方法不存在，那么将引发一个运行时错误。任何拥有这样的正确的”走”和”叫”方法的对象都可被函数接受的这种行为引出了以上表述，这种决定类型的方式因此得名。</p><p>(细心观察的话能发现Lua这门语言处处都是这种设计)</p></blockquote><h1 id="2-代码实现与讲解"><a href="#2-代码实现与讲解" class="headerlink" title="2&#x2F;代码实现与讲解"></a>2&#x2F;代码实现与讲解</h1><p>完整实现：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 基础的类定义函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Class</span><span class="params">(base)</span></span></span><br><span class="line">    <span class="keyword">local</span> class = base <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">    class.new = <span class="function"><span class="keyword">function</span><span class="params">(...)</span></span></span><br><span class="line">        <span class="keyword">local</span> instance = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123;<span class="built_in">__index</span> = class&#125;)</span><br><span class="line">        <span class="keyword">if</span> instance.init <span class="keyword">then</span> instance:init(...) <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">return</span> instance</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> class</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 封装示例</span></span><br><span class="line"><span class="keyword">local</span> Person = Class()</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person:init</span><span class="params">(name)</span></span></span><br><span class="line">    <span class="built_in">self</span>._name = name <span class="comment">-- 使用下划线前缀暗示这是一个私有成员</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person.getName</span><span class="params">(self)</span></span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">self</span>._name</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">Person.<span class="built_in">__index</span> = Person <span class="comment">-- 限制直接访问私有成员</span></span><br><span class="line">Person.<span class="built_in">__newindex</span> = <span class="function"><span class="keyword">function</span><span class="params">(t, k, v)</span></span></span><br><span class="line">    <span class="built_in">error</span>(<span class="string">&quot;Cannot directly assign to private member&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 继承与多态示例</span></span><br><span class="line"><span class="keyword">local</span> Student = Class(Person)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student:init</span><span class="params">(name, school)</span></span></span><br><span class="line">    Person.init(<span class="built_in">self</span>, name) <span class="comment">-- 调用父类构造函数</span></span><br><span class="line">    <span class="built_in">self</span>.school = school</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student:introduce</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I am &quot;</span> .. <span class="built_in">self</span>.getName(<span class="built_in">self</span>) .. <span class="string">&quot;, studying at &quot;</span> .. <span class="built_in">self</span>.school)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建对象并演示</span></span><br><span class="line"><span class="keyword">local</span> alice = Person.new(<span class="string">&quot;Alice&quot;</span>)</span><br><span class="line"><span class="comment">--alice._name = &quot;Bob&quot; -- 尝试修改私有成员会报错</span></span><br><span class="line"><span class="built_in">print</span>(alice.getName(alice)) <span class="comment">-- 正确访问私有成员</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> bob = Student.new(<span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;XYZ University&quot;</span>)</span><br><span class="line">bob:introduce() <span class="comment">-- 多态示例：Student类特有的introduce方法</span></span><br></pre></td></tr></table></figure><h2 id="2-1-创建类的工厂函数"><a href="#2-1-创建类的工厂函数" class="headerlink" title="2.1&#x2F;创建类的工厂函数"></a>2.1&#x2F;创建类的工厂函数</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 基础的类定义函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Class</span><span class="params">(base)</span></span></span><br><span class="line">    <span class="keyword">local</span> class = base <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">    class.new = <span class="function"><span class="keyword">function</span><span class="params">(...)</span></span></span><br><span class="line">        <span class="keyword">local</span> instance = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123;<span class="built_in">__index</span> = class&#125;)</span><br><span class="line">        <span class="keyword">if</span> instance.init <span class="keyword">then</span> instance:init(...) <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">return</span> instance</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> class</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>这个函数在第一行是这样的</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> class = base <span class="keyword">or</span> &#123;&#125;</span><br></pre></td></tr></table></figure><p>对<code>Class()</code>的输入参数做了一个限定,观察后面的代码可知这是为了区分基类与子类而这样处理的，也就是说，有参数就继承父类表，否则就是全新的空表.</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class.new = <span class="function"><span class="keyword">function</span><span class="params">(...)</span></span></span><br><span class="line">        <span class="keyword">local</span> instance = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123;<span class="built_in">__index</span> = class&#125;)</span><br><span class="line">        <span class="keyword">if</span> instance.init <span class="keyword">then</span> instance:init(...) <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">return</span> instance</span><br><span class="line">    <span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>创建一个新的空表<code>instance</code>作为对象实例，并为其设置一个元表（metatable）。元表中的<code>__index</code>元方法被设置为<code>class</code>，这意味着当在<code>instance</code>中找不到某个属性或方法时，Lua会去<code>class</code>表中查找。这种方式实现了方法和属性的继承，以及对实例访问未定义属性时的自动委托。</p><p>之后检查<code>instance</code>表中是否存在一个名为<code>init</code>的初始化方法。如果存在，则调用它，并将接收到的所有参数（通过<code>...</code>）传递给<code>init</code>方法。这一步是实例化过程中初始化对象状态的地方。如果是父类的话，自然没有init方法，所以不会执行，返回空表。</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> class</span><br></pre></td></tr></table></figure><p>最后，Class函数返回class表，这个表现在包含了创建新对象的new方法，以及可能定义的其他类级别的属性和方法，形成了一个可以用来创建对象的“类”。</p><h2 id="2-2-对类进行封装"><a href="#2-2-对类进行封装" class="headerlink" title="2.2&#x2F;对类进行封装"></a>2.2&#x2F;对类进行封装</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 封装示例</span></span><br><span class="line"><span class="keyword">local</span> Person = Class()</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person:init</span><span class="params">(name)</span></span></span><br><span class="line">    <span class="built_in">self</span>._name = name <span class="comment">-- 使用下划线前缀暗示这是一个私有成员</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person.getName</span><span class="params">(self)</span></span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">self</span>._name</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">Person.<span class="built_in">__index</span> = Person <span class="comment">-- 限制直接访问私有成员</span></span><br><span class="line">Person.<span class="built_in">__newindex</span> = <span class="function"><span class="keyword">function</span><span class="params">(t, k, v)</span></span></span><br><span class="line">    <span class="built_in">error</span>(<span class="string">&quot;Cannot directly assign to private member&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>这一部分就是具体对基类进行封装</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person:init</span><span class="params">(name)</span></span></span><br><span class="line">    <span class="built_in">self</span>._name = name <span class="comment">-- 使用下划线前缀暗示这是一个私有成员</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>这里实现的是构造函数，通过<code>self</code>来引用当前对象，<code>self._name</code>来引用当前对象的私有成员<code>_name</code>，<code>self</code>是Lua中的关键字，表示当前对象。定义了Person类的初始化方法<code>init</code>，它接收一个参数<code>name</code>，并将它存储为实例的私有属性<code>_name</code>。在Lua中，虽然没有严格的私有成员概念，但通过约定俗成，使用下划线前缀表示该成员应该是“私有的”，不应直接从外部访问或修改。</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person.getName</span><span class="params">(self)</span></span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">self</span>._name</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>提供一个公共方法<code>getName</code>，用于安全地获取私有属性<code>_name</code>的值。这样，外界可以通过这个方法访问私有成员的值，而不需要直接访问私有属性。</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person.<span class="built_in">__index</span> = Person <span class="comment">-- 限制直接访问私有成员</span></span><br></pre></td></tr></table></figure><p>这行代码设置<code>Person</code>类的元表的<code>__index</code>元方法为自身。这意味着当尝试访问<code>Person</code>实例中不存在的属性时，Lua会去<code>Person</code>类中查找。这本身不直接用于限制访问，但在结合<code>__newindex</code>使用时，有助于控制属性访问。</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Person.<span class="built_in">__newindex</span> = <span class="function"><span class="keyword">function</span><span class="params">(t, k, v)</span></span></span><br><span class="line">    <span class="built_in">error</span>(<span class="string">&quot;Cannot directly assign to private member&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>设置<code>Person</code>类的元表的<code>__newindex</code>元方法。当尝试给<code>Person</code>的实例赋值一个不存在的键（这里通常是尝试修改私有成员）时，这个函数会被调用。在这个例子中，它抛出一个错误，阻止了对任何未明确定义的属性（特别是暗示为私有的属性）的直接赋值，从而实现了对私有成员的保护，强化了封装性。</p><h2 id="2-3-继承与多态"><a href="#2-3-继承与多态" class="headerlink" title="2.3&#x2F;继承与多态"></a>2.3&#x2F;继承与多态</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 继承与多态示例</span></span><br><span class="line"><span class="keyword">local</span> Student = Class(Person)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student:init</span><span class="params">(name, school)</span></span></span><br><span class="line">    Person.init(<span class="built_in">self</span>, name) <span class="comment">-- 调用父类构造函数</span></span><br><span class="line">    <span class="built_in">self</span>.school = school</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student:introduce</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I am &quot;</span> .. <span class="built_in">self</span>.getName(<span class="built_in">self</span>) .. <span class="string">&quot;, studying at &quot;</span> .. <span class="built_in">self</span>.school)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>这段代码就是实际对<code>Person</code>类多态的实现</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> Student = Class(Person)</span><br></pre></td></tr></table></figure><p>这里通过指定<code>Class()</code>参数为<code>Person</code>，创建了一个父类为<code>Person</code>的子类<code>Student</code>，也就是说<code>Student</code>表会继承<code>Person</code>表中的所有属性与方法</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student:init</span><span class="params">(name, school)</span></span></span><br><span class="line">    Person.init(<span class="built_in">self</span>, name) <span class="comment">-- 调用父类构造函数</span></span><br><span class="line">    <span class="built_in">self</span>.school = school</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>在<code>Student</code>类中定义一个初始化方法<code>init</code>。这个方法首先通过<code>Person.init(self, name)</code>调用了父类的初始化方法，实现了父类属性（在这个案例中是<code>name</code>）的初始化。然后，它为<code>Student</code>类添加了一个新的属性<code>school</code>，并赋予传入的值。这是继承的一个典型应用，即子类可以在保留父类特性的同时，扩展自己的特性。</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student:introduce</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I am &quot;</span> .. <span class="built_in">self</span>.getName(<span class="built_in">self</span>) .. <span class="string">&quot;, studying at &quot;</span> .. <span class="built_in">self</span>.school)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>定义了<code>Student</code>类的一个新方法<code>introduce</code>。这个方法打印出学生的名字（通过调用继承自<code>Person</code>类的<code>getName</code>方法得到）和学校名字。这里体现了多态性：尽管<code>getName</code>方法是从父类继承而来，<code>Student</code>类通过扩展自己的方法（<code>introduce</code>），以特定于子类的方式使用了这个继承的方法，展示了不同的行为。这说明即使使用了同样的方法名（如<code>getName</code>），在不同类的上下文中可以有不同的表现，符合面向对象编程中多态的概念。</p><h2 id="2-4-实例化与使用"><a href="#2-4-实例化与使用" class="headerlink" title="2.4&#x2F;实例化与使用"></a>2.4&#x2F;实例化与使用</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建对象并演示</span></span><br><span class="line"><span class="keyword">local</span> alice = Person.new(<span class="string">&quot;Alice&quot;</span>)</span><br><span class="line"><span class="comment">--alice._name = &quot;Bob&quot; -- 尝试修改私有成员会报错</span></span><br><span class="line"><span class="built_in">print</span>(alice.getName(alice)) <span class="comment">-- 正确访问私有成员</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> bob = Student.new(<span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;XYZ University&quot;</span>)</span><br><span class="line">bob:introduce() <span class="comment">-- 多态示例：Student类特有的introduce方法</span></span><br></pre></td></tr></table></figure><p>这一段就是对我们刚才定义的<code>Person</code>与<code>Student</code>类的实际使用</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> alice = Person.new(<span class="string">&quot;Alice&quot;</span>)</span><br></pre></td></tr></table></figure><p>这行代码通过调用<code>Person</code>类的<code>new</code>方法创建了一个名为<code>alice</code>的<code>Person</code>对象，并将名字设为”Alice”。<code>alice</code>现在是一个包含了<code>_name属性</code>（尽管是私有的）和<code>getName</code>方法等的实例。</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(alice.getName(alice)) <span class="comment">-- 正确访问私有成员</span></span><br></pre></td></tr></table></figure><p>通过调用<code>alice</code>对象的<code>getName</code>方法来间接访问其私有属性<code>_name</code>，并打印出<code>&quot;Alice&quot;</code>。这种方法允许安全地访问和展示私有数据，而不违反封装原则。</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> bob = Student.new(<span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;XYZ University&quot;</span>)</span><br></pre></td></tr></table></figure><p>创建了一个名为<code>bob</code>的<code>Student</code>对象，继承了<code>Person</code>类的属性和方法，并且具有额外的属性<code>school</code>，初始化为<code>&quot;XYZ University&quot;</code>。</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bob:introduce() <span class="comment">-- 多态示例：Student类特有的introduce方法</span></span><br></pre></td></tr></table></figure><p>调用<code>bob</code>对象的<code>introduce</code>方法，这是<code>Student</code>类新增的方法，用于介绍学生自己。这个方法展示了多态性：虽然<code>getName</code>方法是继承自<code>Person</code>类的，但通过<code>Student</code>类的上下文（即<code>introduce</code>方法），它以一种特定于<code>Student</code>类的方式来使用，即不仅打印名字，还打印学校信息。这表明，尽管方法名相同，但通过不同类的不同实现，可以产生不同的行为，是面向对象多态性的直接体现。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;0-前言&quot;&gt;&lt;a href=&quot;#0-前言&quot; class=&quot;headerlink&quot; title=&quot;0&amp;#x2F;前言&quot;&gt;&lt;/a&gt;0&amp;#x2F;前言&lt;/h1&gt;&lt;p&gt;可能这就是报应吧，刚开始工作的时候没好好学Lua，平常就是把它当成了python这样的其他脚本语言来用，</summary>
      
    
    
    
    <category term="工作经验" scheme="https://mralridge.github.io/categories/%E5%B7%A5%E4%BD%9C%E7%BB%8F%E9%AA%8C/"/>
    
    
    <category term="Lua" scheme="https://mralridge.github.io/tags/Lua/"/>
    
    <category term="面向对象" scheme="https://mralridge.github.io/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
    
  </entry>
  
  <entry>
    <title>有关流程图</title>
    <link href="https://mralridge.github.io/2024/07/01/%E6%9C%89%E5%85%B3%E6%B5%81%E7%A8%8B%E5%9B%BE/"/>
    <id>https://mralridge.github.io/2024/07/01/%E6%9C%89%E5%85%B3%E6%B5%81%E7%A8%8B%E5%9B%BE/</id>
    <published>2024-07-01T03:08:18.000Z</published>
    <updated>2024-07-01T03:14:35.342Z</updated>
    
    <content type="html"><![CDATA[<div class="note info flat"><p>统一规定的标准符号，不能乱用，不然就不好理解了。</p></div><p><img src="https://img-blog.csdnimg.cn/img_convert/1b269a05f6f87cb0d6b39af1a9c9aa61.png" alt="流程图标准符号"></p><div class="note info flat"><p>循环的标准结构</p></div><p><img src="https://img-blog.csdnimg.cn/img_convert/dc9578956a58fa73052567f481d7f87f.png" alt="循环的标准结构"></p><div class="note info flat"><p>注解符号的使用</p></div><p><img src="https://img-blog.csdnimg.cn/img_convert/54dc82c59758c017d8d912fec964c0d5.png" alt="注解符号的使用"></p><p>基本结构:</p><ul><li>顺序型</li></ul><p><img src="https://img-blog.csdnimg.cn/img_convert/a54b3bd6cfa3d1ca25c772f2c0c600cd.png" alt="顺序型"></p><ul><li>选择型</li></ul><p><img src="https://img-blog.csdnimg.cn/img_convert/3426a073beb7ac010fcbc0786c5adf15.png" alt="选择型"></p><ul><li>先判定（while）循环</li></ul><p><img src="https://img-blog.csdnimg.cn/img_convert/c3cb9ce45c418e7631c43a24d70fe21e.png" alt="先while"></p><ul><li>后判定（util）循环</li></ul><p><img src="https://img-blog.csdnimg.cn/img_convert/5fe4a29d89f009772966a049ce74bc24.png" alt="后until"></p><ul><li>case选择</li></ul><p><img src="https://img-blog.csdnimg.cn/img_convert/de2c6a6412c304dfdce904367f5837bf.png" alt="case"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;note info flat&quot;&gt;&lt;p&gt;统一规定的标准符号，不能乱用，不然就不好理解了。&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;https://img-blog.csdnimg.cn/img_convert/1b269a05f6f87cb0d6b</summary>
      
    
    
    
    
    <category term="工作技能" scheme="https://mralridge.github.io/tags/%E5%B7%A5%E4%BD%9C%E6%8A%80%E8%83%BD/"/>
    
    <category term="基本功" scheme="https://mralridge.github.io/tags/%E5%9F%BA%E6%9C%AC%E5%8A%9F/"/>
    
  </entry>
  
  <entry>
    <title>UML学习记录</title>
    <link href="https://mralridge.github.io/2024/06/29/UML%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    <id>https://mralridge.github.io/2024/06/29/UML%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</id>
    <published>2024-06-29T09:39:27.000Z</published>
    <updated>2024-07-01T03:02:41.840Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0-什么是UML"><a href="#0-什么是UML" class="headerlink" title="0&#x2F;什么是UML?"></a>0&#x2F;什么是UML?</h1><p>UML——Unified modeling language UML(统一建模语言)，是一种用于软件系统分析和设计的语言工具，它用于帮助软件开发人员进行思考和记录思路的结果.</p><p>UML本身是一套符号的规定，就像数学符号和化学符号一样，这些符号用于描述软件模型中的各个元素和他们之间的关系，比如类、接口、实现、泛化、依赖、组合、聚合等</p><h1 id="1-UML的分类"><a href="#1-UML的分类" class="headerlink" title="1&#x2F;UML的分类"></a>1&#x2F;UML的分类</h1><h2 id="1-1-UML图"><a href="#1-1-UML图" class="headerlink" title="1.1&#x2F;UML图"></a>1.1&#x2F;UML图</h2><p>UML图本质上是将你的想法转述给别人,所以主要分为以下几类:</p><ul><li>用例图</li><li>静态结构图:类图、对象图、包图、组件图、部署图</li><li>动态行为图:交互图（时序图与协作图）、状态图、活动图</li></ul><p>类图是用来描述类与类之间的关系的，所以是UML图中最核心的。</p><h2 id="1-2-UML类图"><a href="#1-2-UML类图" class="headerlink" title="1.2&#x2F;UML类图"></a>1.2&#x2F;UML类图</h2><p>类图用于描述系统中的类（对象）本身的<code>组成</code>和类（对象）之间的各种<code>静态关系</code>,类之间的关系有：</p><ul><li>依赖</li><li>泛化（继承）</li><li>实现</li><li>关联</li><li>聚合与组合</li></ul><p>所以类图可以用以下例子来解释</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>用类图就可以表示为</p><p><img src="https://s21.ax1x.com/2024/06/29/pkcpRW4.png" alt="用UML表示上面的代码"></p><h1 id="2-类图关系"><a href="#2-类图关系" class="headerlink" title="2&#x2F;类图关系"></a>2&#x2F;类图关系</h1><h2 id="2-0-类图关系概述"><a href="#2-0-类图关系概述" class="headerlink" title="2.0&#x2F;类图关系概述"></a>2.0&#x2F;类图关系概述</h2><blockquote><ul><li>设计一个类中的信息和行为要实现<code>高内聚</code></li><li>设计多个类，类之间要做到<code>低耦合</code></li></ul></blockquote><p>在实际的系统应用中，我们所<code>创建的多个对象往往是有联系</code>的, 通常情况下对象之间的关系可以分为以下几类：</p><ul><li>泛化关系</li><li>实现关系</li><li>依赖关系</li><li>关联关系</li><li>聚合关系</li><li>组合关系</li></ul><h2 id="2-1-泛化（继承）关系"><a href="#2-1-泛化（继承）关系" class="headerlink" title="2.1&#x2F;泛化（继承）关系"></a>2.1&#x2F;泛化（继承）关系</h2><p>简单的说，<code>泛化</code>就是<code>继承</code>,即一个类（我们称之为子类，子接口）继承(<code>extend</code>)另外一个类（我们称之为父类，父接口）的功能，并且可以增加自己<code>额外的</code>一些功能。</p><p>在UML关系中，继承通常使用<strong>空心三角+实线</strong>表示.</p><p>接口间的继承关系通常用圆心表示，而类之间的继承关系通常用矩形表示</p><p><img src="https://s21.ax1x.com/2024/06/29/pkc9ApQ.png" alt="UML表示类的继承"></p><h2 id="2-2-实现关系"><a href="#2-2-实现关系" class="headerlink" title="2.2&#x2F;实现关系"></a>2.2&#x2F;实现关系</h2><p>在UML关系中,实现通常使用<strong>空心三角+虚线</strong>表示</p><p>表示一个类实现一个或多个接口的功能</p><p><img src="https://s21.ax1x.com/2024/07/01/pkcgXPe.png" alt="UML表示类的实现"></p><h2 id="2-3-依赖关系"><a href="#2-3-依赖关系" class="headerlink" title="2.3&#x2F;依赖关系"></a>2.3&#x2F;依赖关系</h2><p>在UML关系中，依赖常用<strong>虚线箭头</strong>表示</p><p>表示<code>一个类依赖于另一个类的定义</code>,表示如果A对象离开了B对象，A对象无法通过编译，则此时A对象依赖于B对象（A类中使用到了B对象）</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Weapon</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> damage;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Player</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Weapon weapon = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> damage;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> hp;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Attack</span>(<span class="params">Player target</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (weapon != <span class="literal">null</span>) &#123;</span><br><span class="line">            target.hp -= weapon.damage + damage;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            target.hp -= damage;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s21.ax1x.com/2024/07/01/pkc2MZV.png" alt="UML表示类的依赖"></p><h2 id="2-4-关联关系"><a href="#2-4-关联关系" class="headerlink" title="2.4&#x2F;关联关系"></a>2.4&#x2F;关联关系</h2><p>UML关系中，关联关系通常使用<strong>实线箭头</strong>表示</p><h3 id="2-4-1-一对一关系"><a href="#2-4-1-一对一关系" class="headerlink" title="2.4.1&#x2F;一对一关系"></a>2.4.1&#x2F;一对一关系</h3><div class="note info flat"><p>单向关联</p></div><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">QQNumber</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> QQZone zone;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">QQZone</span>&#123;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s21.ax1x.com/2024/07/01/pkc2sRH.png" alt="单向一对一"></p><div class="note info flat"><p>双向关联</p></div><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">QQNumber</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> QQZone zone;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">QQZone</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> QQNumber number;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s21.ax1x.com/2024/07/01/pkc22Lt.png" alt="双向一对一"></p><h3 id="2-4-2-单向的一对多"><a href="#2-4-2-单向的一对多" class="headerlink" title="2.4.2&#x2F;单向的一对多"></a>2.4.2&#x2F;单向的一对多</h3><div class="note info flat"><p>一个A对象属于多个B对象，并且每个B对象只能属于一个A对象</p></div><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Department</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;Employee&gt; emps = <span class="keyword">new</span> List&lt;Employee&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s21.ax1x.com/2024/07/01/pkcRPyR.png" alt="单向一对多"></p><h3 id="2-4-3-单向的多对一"><a href="#2-4-3-单向的多对一" class="headerlink" title="2.4.3&#x2F;单向的多对一"></a>2.4.3&#x2F;单向的多对一</h3><div class="note info flat"><p>多个A对象属于一个B对象，并且每个A对象只能属于一个B对象</p></div><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Department</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> Department dept;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s21.ax1x.com/2024/07/01/pkcWF3Q.png" alt="单向多对一"></p><h3 id="2-4-4-双向一对多，多对一"><a href="#2-4-4-双向一对多，多对一" class="headerlink" title="2.4.4&#x2F;双向一对多，多对一"></a>2.4.4&#x2F;双向一对多，多对一</h3><div class="note info flat"><p>A可以通过属性导航到B，B可以通过属性导航到A，本质上是把两个单向关系组合起来</p></div><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Department dept;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Department</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Employee&gt; emps = <span class="keyword">new</span> List&lt;Employee&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s21.ax1x.com/2024/07/01/pkcWsKA.png" alt="双向关系"></p><h3 id="2-4-5-单向多对多"><a href="#2-4-5-单向多对多" class="headerlink" title="2.4.5&#x2F;单向多对多"></a>2.4.5&#x2F;单向多对多</h3><div class="note info flat"><p>一个A对象属于多个B对象，一个B对象也属于多个A对象</p></div><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Student</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Teacher&gt; teachers = <span class="keyword">new</span> List&lt;Teacher&gt;();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Teacher</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; students = <span class="keyword">new</span> List&lt;Student&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s21.ax1x.com/2024/07/01/pkcWR58.png" alt="单向多对多"></p><h2 id="2-5-聚合关系"><a href="#2-5-聚合关系" class="headerlink" title="2.5&#x2F;聚合关系"></a>2.5&#x2F;聚合关系</h2><blockquote><p>聚合关系是<code>关联关系的一种特例</code>，他体现的是<code>整体与部分</code>，是一种<code>“弱拥有”</code>的关系，即<code>has-a</code>的关系。聚合是<code>整体</code>和<code>个体</code>之间的关系</p></blockquote><p>关联关系所设计的两个类是要处在同一个层次上的，而在聚合关系中，两个类是处在不平等的层次上的，一个代表整体，一个代表部分。</p><p>聚合通常使用<strong>空心菱形+实心箭头</strong>表示</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Phone</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title">Card</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Card</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s21.ax1x.com/2024/07/01/pkcfAPO.png" alt="聚合关系"></p><h2 id="2-6-组合关系"><a href="#2-6-组合关系" class="headerlink" title="2.6&#x2F;组合关系"></a>2.6&#x2F;组合关系</h2><p>组合关系也是<code>关联关系的一种特例</code>，体现的是一种<code>contains-a</code>(包含)关系，比聚合更强，所以也是<code>强聚合</code></p><blockquote><p>整体和个体不能独立存在，一定是在一个模块中同时管理整体和个体，生命周期必须相同(级联)。</p></blockquote><div class="note info flat"><p>按照我的理解就是字面意思，出现一定是”组合”起来出现，不会两个人单独出现</p></div><p>组合通常使用<strong>实心菱形+实线箭头</strong>表示</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderBill</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;OrderBillItem&gt; items = <span class="keyword">new</span> List&lt;OrderBillItem&gt;();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderBillItem</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> OrderBill bill;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s21.ax1x.com/2024/07/01/pkcfWe1.png" alt="组合关系"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;0-什么是UML&quot;&gt;&lt;a href=&quot;#0-什么是UML&quot; class=&quot;headerlink&quot; title=&quot;0&amp;#x2F;什么是UML?&quot;&gt;&lt;/a&gt;0&amp;#x2F;什么是UML?&lt;/h1&gt;&lt;p&gt;UML——Unified modeling language UML</summary>
      
    
    
    
    
    <category term="UML" scheme="https://mralridge.github.io/tags/UML/"/>
    
    <category term="工作技能" scheme="https://mralridge.github.io/tags/%E5%B7%A5%E4%BD%9C%E6%8A%80%E8%83%BD/"/>
    
    <category term="基本功" scheme="https://mralridge.github.io/tags/%E5%9F%BA%E6%9C%AC%E5%8A%9F/"/>
    
  </entry>
  
  <entry>
    <title>浅入浅出游戏引擎笔记（二）</title>
    <link href="https://mralridge.github.io/2024/06/29/%E6%B5%85%E5%85%A5%E6%B5%85%E5%87%BA2/"/>
    <id>https://mralridge.github.io/2024/06/29/%E6%B5%85%E5%85%A5%E6%B5%85%E5%87%BA2/</id>
    <published>2024-06-29T07:27:12.000Z</published>
    <updated>2024-06-29T09:25:15.586Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-索引与缓冲区对象"><a href="#1-索引与缓冲区对象" class="headerlink" title="1&#x2F;索引与缓冲区对象"></a>1&#x2F;索引与缓冲区对象</h2><p>在上一章的实例中,引擎主循环每执行一次,就要上传顶点数据到GPU来实现渲染.对于简单的图形来说,这是可以接受的.但是实际项目中动辄几W的顶点数量不可能也使用这种方法来处理顶点,不然每一帧都要把所有顶点上传一次,那主循环不用干别的事了.</p><p>所以要优化这种情况,有两种方式:</p><ul><li>减少数据上传量</li><li>在<code>GPU</code>上缓存数据</li></ul><p>OpenGL对应的提供了两种方法来实现,分别是<code>顶点索引</code>和<code>缓冲区对象</code>.</p><h3 id="1-1-顶点数组对象"><a href="#1-1-顶点数组对象" class="headerlink" title="1.1&#x2F;顶点数组对象"></a>1.1&#x2F;顶点数组对象</h3><p>而且各位不要忘了,OpenGL是一个典型的<code>C/S</code>架构,也就是说CPU在OpenGL里面扮演的是<code>客户端</code>的角色,而GPU在OpenGL里面扮演的是<code>服务端</code>的角色.</p><p>这就会产生一个问题:CPU在通知GPU执行一个API之后,必须等待GPU返回一个结果之后才能继续执行下一个API.换句话说,要调用的OpenGL API越多,性能就越差(要等待很多次返回结果)</p><p>那么有没有一种方法,把数个命令的结果保存在GPU上面,CPU只需要调用一个API就可以完成执行数个命令的结果呢?</p><p>答案是<code>顶点数组对象</code></p><h4 id="1-1-1-何为顶点索引"><a href="#1-1-1-何为顶点索引" class="headerlink" title="1.1.1&#x2F;何为顶点索引"></a>1.1.1&#x2F;何为顶点索引</h4><p>回顾之前画矩形的时候,我们上传了6个顶点,但是实际上只有4个顶点是真正有用的,剩余两个顶点只是为了凑出两个三角形而上传的.这样不仅增加了顶点的上传数量,也增加了GPU顶点着色器的运行次数</p><p>以正方形的顶点坐标为例,顶点坐标是一个数组,那么顶点索引就是这个数组的index</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">const</span> glm::vec3 kPositions[<span class="number">6</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//第一个三角形</span></span><br><span class="line">    &#123; <span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">0.0f</span>&#125;,<span class="comment">//左下</span></span><br><span class="line">    &#123;  <span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">0.0f</span>&#125;,<span class="comment">//右下</span></span><br><span class="line">    &#123;  <span class="number">1.0f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>&#125;,<span class="comment">//右上</span></span><br><span class="line">    <span class="comment">//第二个三角形</span></span><br><span class="line">    &#123;  <span class="number">1.0f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>&#125;,<span class="comment">//右上</span></span><br><span class="line">    &#123; <span class="number">-1.0f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>&#125;,<span class="comment">//左上</span></span><br><span class="line">    &#123; <span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">0.0f</span>&#125;<span class="comment">//左下</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>去掉重复的定点之后,其实只有四个顶点</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">const</span> glm::vec3 kPositions[<span class="number">4</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    &#123; <span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">0.0f</span>&#125;,<span class="comment">//左下</span></span><br><span class="line">    &#123;  <span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">0.0f</span>&#125;,<span class="comment">//右下</span></span><br><span class="line">    &#123;  <span class="number">1.0f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>&#125;,<span class="comment">//右上</span></span><br><span class="line">    &#123; <span class="number">-1.0f</span>,  <span class="number">1.0f</span>, <span class="number">0.0f</span>&#125;,<span class="comment">//左上</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>但是只有4个顶点的情况下,如何组成两个三角形呢?答案是去重之后的顶点坐标数据不重复,但是可以新建一个数组,存储重复的顶点索引,利用索引调用顶点坐标</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">const</span> glm::vec3 indices[<span class="number">6</span>] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//第一个三角形</span></span><br><span class="line">    <span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,</span><br><span class="line">    <span class="comment">//第二个三角形</span></span><br><span class="line">    <span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>借助顶点索引数组,我们间接地形成了两个三角形.</p><h4 id="1-1-2-何为顶点"><a href="#1-1-2-何为顶点" class="headerlink" title="1.1.2&#x2F;何为顶点"></a>1.1.2&#x2F;何为顶点</h4><p>在作者之前的文章中,使用了如下的代码来设置了顶点的属性</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">glVertexAttribPointer</span>(vpos_location, <span class="number">3</span>, GL_FLOAT, <span class="literal">false</span>, <span class="built_in">sizeof</span>(glm::vec3), kPositions);</span><br></pre></td></tr></table></figure><p>具体绘制多少个顶点,是在如下代码中决定的</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">glDrawArrays</span>(GL_TRIANGLES, <span class="number">0</span>, <span class="number">6</span>*<span class="number">6</span>);<span class="comment">//表示从第0个顶点开始画，总共画6个面，每个面6个顶点(两个三角形)。</span></span><br></pre></td></tr></table></figure><p>之前我们提到过,顶点着色器是每个顶点都要执行一次.换句话说,<code>glDrawArrays</code>制定了多少个顶点,就执行多少次.</p><blockquote><p>那么每次执行，就以当前顶点序号为下标，从<code>glVertexAttribPointer</code>设置的顶点属性去拿数据，设置到顶点shader的变量<code>vpos_location</code>中。</p><p>那么顶点属性的数据，这个数组，长度一定是要等于<code>glDrawArrays</code>指定的顶点数的，不然就会取不到数据。</p><p>按照这个逻辑，我将所有用<code>glVertexAttribPointer</code>设置的顶点属性，相同下标的，称之为一个顶点。</p></blockquote><p><img src="https://s21.ax1x.com/2024/06/29/pkcSY8J.png" alt="大概是这个意思"></p><p>也就是说,<code>一个顶点</code>包含了</p><ul><li>坐标</li><li>颜色</li><li>UV坐标</li></ul><p>三个数据,只要这三个数据有一个不同,那就不能称之为<code>两个相同的顶点</code>.也就是说,使用顶点索引需要去重,本质上是去掉三者完全相同的顶点.</p><p>因此,对于项目中存放顶点的定义<code>vertex_data.h</code>需要修改为如下代码.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//顶点</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Vertex</span></span><br><span class="line">&#123;</span><br><span class="line">    glm::vec3 pos_;</span><br><span class="line">    glm::vec4 color_;</span><br><span class="line">    glm::vec2 uv_;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> Vertex kVertexs[<span class="number">36</span>] =&#123;</span><br><span class="line">    <span class="comment">//Front</span></span><br><span class="line">    glm::<span class="built_in">vec3</span>(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>), glm::<span class="built_in">vec4</span>(<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>),   glm::<span class="built_in">vec2</span>(<span class="number">0.0f</span>, <span class="number">0.0f</span>),</span><br><span class="line">    glm::<span class="built_in">vec3</span>( <span class="number">1.0f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>), glm::<span class="built_in">vec4</span>(<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>),   glm::<span class="built_in">vec2</span>(<span class="number">1.0f</span>, <span class="number">0.0f</span>),</span><br><span class="line">    glm::<span class="built_in">vec3</span>( <span class="number">1.0f</span>,  <span class="number">1.0f</span>, <span class="number">1.0f</span>), glm::<span class="built_in">vec4</span>(<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>),   glm::<span class="built_in">vec2</span>(<span class="number">1.0f</span>, <span class="number">1.0f</span>),</span><br><span class="line">    glm::<span class="built_in">vec3</span>(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>), glm::<span class="built_in">vec4</span>(<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>),   glm::<span class="built_in">vec2</span>(<span class="number">0.0f</span>, <span class="number">0.0f</span>),</span><br><span class="line">    glm::<span class="built_in">vec3</span>( <span class="number">1.0f</span>,  <span class="number">1.0f</span>, <span class="number">1.0f</span>), glm::<span class="built_in">vec4</span>(<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>),   glm::<span class="built_in">vec2</span>(<span class="number">1.0f</span>, <span class="number">1.0f</span>),</span><br><span class="line">    glm::<span class="built_in">vec3</span>(<span class="number">-1.0f</span>,  <span class="number">1.0f</span>, <span class="number">1.0f</span>), glm::<span class="built_in">vec4</span>(<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>),   glm::<span class="built_in">vec2</span>(<span class="number">0.0f</span>, <span class="number">1.0f</span>),</span><br><span class="line">    <span class="comment">//back</span></span><br><span class="line">    glm::<span class="built_in">vec3</span>(<span class="number">-1.0f</span>, <span class="number">-1.0f</span>, <span class="number">-1.0f</span>), glm::<span class="built_in">vec4</span>(<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>,<span class="number">1.0f</span>),   glm::<span class="built_in">vec2</span>(<span class="number">0.0f</span>, <span class="number">0.0f</span>),</span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>至此,我们已经模糊掉了顶点属性的概念,我们面对的是整个顶点对象.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-索引与缓冲区对象&quot;&gt;&lt;a href=&quot;#1-索引与缓冲区对象&quot; class=&quot;headerlink&quot; title=&quot;1&amp;#x2F;索引与缓冲区对象&quot;&gt;&lt;/a&gt;1&amp;#x2F;索引与缓冲区对象&lt;/h2&gt;&lt;p&gt;在上一章的实例中,引擎主循环每执行一次,就要上传顶点数据</summary>
      
    
    
    
    <category term="浅入浅出游戏引擎" scheme="https://mralridge.github.io/categories/%E6%B5%85%E5%85%A5%E6%B5%85%E5%87%BA%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E/"/>
    
    
    <category term="c++" scheme="https://mralridge.github.io/tags/c/"/>
    
    <category term="游戏引擎" scheme="https://mralridge.github.io/tags/%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E/"/>
    
    <category term="浅入浅出" scheme="https://mralridge.github.io/tags/%E6%B5%85%E5%85%A5%E6%B5%85%E5%87%BA/"/>
    
    <category term="OpenGL" scheme="https://mralridge.github.io/tags/OpenGL/"/>
    
  </entry>
  
  <entry>
    <title>网游中常见的&quot;随机&quot;</title>
    <link href="https://mralridge.github.io/2024/06/28/%E7%BD%91%E6%B8%B8%E5%B8%B8%E8%A7%81%E6%A6%82%E7%8E%87%E6%8E%A7%E5%88%B6/"/>
    <id>https://mralridge.github.io/2024/06/28/%E7%BD%91%E6%B8%B8%E5%B8%B8%E8%A7%81%E6%A6%82%E7%8E%87%E6%8E%A7%E5%88%B6/</id>
    <published>2024-06-28T08:59:09.000Z</published>
    <updated>2024-06-28T10:00:45.019Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0-前言"><a href="#0-前言" class="headerlink" title="0&#x2F;前言"></a>0&#x2F;前言</h3><p>从开始工作到现在对于游戏中的”随机”也接触了不少,这篇文章就来整理一下目前我对游戏中如何控制”随机”的看法</p><h3 id="1-从最基础的开始"><a href="#1-从最基础的开始" class="headerlink" title="1&#x2F;从最基础的开始"></a>1&#x2F;从最基础的开始</h3><p>现在让我们来设计一个玩法</p><blockquote><p>这是一个回合制RPG游戏,现在有10层地图,每层地图都有一些随时刷新的游荡小怪,击败这些小怪就可以获得某种的材料</p></blockquote><p>这样一个简单的玩法,我们有以下几种设计方法</p><h4 id="1-1-依据层数的随机"><a href="#1-1-依据层数的随机" class="headerlink" title="1.1&#x2F;依据层数的随机"></a>1.1&#x2F;依据层数的随机</h4><p>顾名思义,地图层数越高,材料的产出概率越高,同时材料的获取效率也会变高</p><p>这样设计的好处是玩家的产出与实例相绑定,驱动玩家去推进地图进度.</p><p>当然这种设计方式也有一些问题,例如</p><ul><li>材料不能与地图进度绑定(提交材料进入下层地图)</li><li>每层材料的产出需要经过调整(如果你打到最高层,每次打怪的最高产出还是和第一层一样,那就没有意思了)</li></ul><h4 id="1-2-依据次数的随机"><a href="#1-2-依据次数的随机" class="headerlink" title="1.2&#x2F;依据次数的随机"></a>1.2&#x2F;依据次数的随机</h4><p>这种方式将产出与地图分离开来,具体的做法是设定每日前XX次是一个概率,之后XXX次是一个概率,XXX次之后是固定概率</p><p>这样做的好处是可以控制玩家每日产出的大体上限,如下表所示</p><table><thead><tr><th align="center">次数</th><th align="center">不掉</th><th align="center">掉1个</th><th align="center">掉2个</th><th align="center">掉5个</th><th align="center">产出期望(E)</th><th align="center">打满可得</th></tr></thead><tbody><tr><td align="center">1-10次</td><td align="center">4000</td><td align="center">3000</td><td align="center">2000</td><td align="center">1000</td><td align="center">1.2</td><td align="center">12</td></tr><tr><td align="center">10-15次</td><td align="center">4500</td><td align="center">2900</td><td align="center">1800</td><td align="center">800</td><td align="center">1.05</td><td align="center">17.25</td></tr><tr><td align="center">15-20次</td><td align="center">5000</td><td align="center">2800</td><td align="center">1600</td><td align="center">600</td><td align="center">0.9</td><td align="center">21.75</td></tr><tr><td align="center">20-25次</td><td align="center">5500</td><td align="center">2700</td><td align="center">1400</td><td align="center">400</td><td align="center">0.75</td><td align="center">25.5</td></tr><tr><td align="center">25-30次</td><td align="center">6000</td><td align="center">2600</td><td align="center">1200</td><td align="center">200</td><td align="center">0.6</td><td align="center">28.5</td></tr><tr><td align="center">30-40次</td><td align="center">6500</td><td align="center">2300</td><td align="center">1000</td><td align="center">200</td><td align="center">0.53</td><td align="center">33.8</td></tr><tr><td align="center">40-60次</td><td align="center">8000</td><td align="center">1000</td><td align="center">800</td><td align="center">200</td><td align="center">0.36</td><td align="center">41</td></tr><tr><td align="center">60-90次</td><td align="center">9000</td><td align="center">400</td><td align="center">400</td><td align="center">200</td><td align="center">0.22</td><td align="center">47.6</td></tr><tr><td align="center">90次以上</td><td align="center">9500</td><td align="center">200</td><td align="center">200</td><td align="center">100</td><td align="center">0.11</td><td align="center"></td></tr></tbody></table><p>不过这样设计的话就只适用于材料与地图绑定的情况,此时玩家刷这个材料只是为了进入下一个地图,那么你就要在下一个地图为玩家设置足以驱动玩家打材料的奖励</p><p>(To Be Continued)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;0-前言&quot;&gt;&lt;a href=&quot;#0-前言&quot; class=&quot;headerlink&quot; title=&quot;0&amp;#x2F;前言&quot;&gt;&lt;/a&gt;0&amp;#x2F;前言&lt;/h3&gt;&lt;p&gt;从开始工作到现在对于游戏中的”随机”也接触了不少,这篇文章就来整理一下目前我对游戏中如何控制”随机”的看</summary>
      
    
    
    
    <category term="工作经验" scheme="https://mralridge.github.io/categories/%E5%B7%A5%E4%BD%9C%E7%BB%8F%E9%AA%8C/"/>
    
    
    <category term="游戏开发" scheme="https://mralridge.github.io/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/"/>
    
    <category term="游戏设计" scheme="https://mralridge.github.io/tags/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>(1) 基础的战斗实现 - RE:从0开始的RPG游戏制作</title>
    <link href="https://mralridge.github.io/2024/06/26/%E6%88%98%E6%96%97%E9%83%A8%E5%88%86%E5%9F%BA%E7%A1%80/"/>
    <id>https://mralridge.github.io/2024/06/26/%E6%88%98%E6%96%97%E9%83%A8%E5%88%86%E5%9F%BA%E7%A1%80/</id>
    <published>2024-06-26T07:39:54.000Z</published>
    <updated>2024-06-27T09:48:01.197Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0-基本结构"><a href="#0-基本结构" class="headerlink" title="0&#x2F;基本结构"></a>0&#x2F;基本结构</h3><p>在上一章我们已经想好我们要做什么事了，那么从现在开始就要落实下去。根据我们之前的设想，战斗部分的逻辑可以用这张图来表示。</p><p><img src="https://s21.ax1x.com/2024/06/26/pkyeodA.png" alt="最初的战斗逻辑"></p><p>乍一看在玩家眼中确实是这样的，我们不妨想的更详细一些，把buff之类的东西考虑进去，之后我们就能得到下面这张图</p><p><img src="https://s21.ax1x.com/2024/06/26/pkynG90.png" alt="优化过后的战斗逻辑"></p><p>虽然这个流程图还没有详细到我们实际实现的部分，但是我们可以根据这个流程图来搭建一个框架</p><h3 id="1-战斗管理器"><a href="#1-战斗管理器" class="headerlink" title="1&#x2F;战斗管理器"></a>1&#x2F;战斗管理器</h3><p>根据我之前那堪称贫瘠的项目经验，把逻辑与数据分开是最好的实现方式。这种思想就有点类似于工厂模式，我们在定义好“战斗工厂”以后，每次想要开启战斗就让“战斗工厂”去“生产”一个出来就好了。</p><p>所以我们要创建脚本<code>Script\System\BattleManager.cs</code>来实现。</p><div class="note info flat"><p>强烈推荐在创建代码的时候，预先设计好项目的目录结构，不然代码多了之后就会非常折磨人<br>所以我比较推荐的目录结构是下面这样</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">D:\U3DPROJ\RPG\ASSETS        </span><br><span class="line">├─Scenes</span><br><span class="line">└─Scripts</span><br><span class="line">    ├─DataDef</span><br><span class="line">    ├─System</span><br><span class="line">    └─UI</span><br></pre></td></tr></table></figure></div><p>这里我就直接贴出代码,之后再一段一段讲解</p><h4 id="1-0-枚举定义"><a href="#1-0-枚举定义" class="headerlink" title="1.0&#x2F;枚举定义"></a>1.0&#x2F;枚举定义</h4><p>首先我们要将一些枚举提前定义下来</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 所有与战斗有关的常量都在这定义</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BattleDef</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 战斗的状态标志</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> BattleState : <span class="built_in">byte</span></span><br><span class="line">&#123;</span><br><span class="line">    Enter = <span class="number">0</span>,      <span class="comment">// 进入战斗</span></span><br><span class="line">    BeforeAct = <span class="number">1</span>,  <span class="comment">// 行动前</span></span><br><span class="line">    SelectAct = <span class="number">2</span>,  <span class="comment">// 选择行动中</span></span><br><span class="line">    Acting = <span class="number">3</span>,     <span class="comment">// 行动表演中</span></span><br><span class="line">    AfterAct = <span class="number">4</span>,   <span class="comment">// 行动后</span></span><br><span class="line">    ResultWin = <span class="number">5</span>,  <span class="comment">// 战斗胜利</span></span><br><span class="line">    ResultLose = <span class="number">6</span>, <span class="comment">// 战斗失败</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Buff触发的时机</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> BuffTime : <span class="built_in">byte</span></span><br><span class="line">&#123;</span><br><span class="line">    None = <span class="number">0</span>,</span><br><span class="line">    Enter = <span class="number">1</span>,          <span class="comment">// 自身入场时</span></span><br><span class="line">    Exit = <span class="number">2</span>,           <span class="comment">// 自身离场时</span></span><br><span class="line">    BeforeAct = <span class="number">3</span>,      <span class="comment">// 自身行动前</span></span><br><span class="line">    AfterAct = <span class="number">4</span>,       <span class="comment">// 自身行动后</span></span><br><span class="line">    AddBuff = <span class="number">5</span>,        <span class="comment">// 添加其他增益时</span></span><br><span class="line">    RemoveBuff = <span class="number">6</span>,     <span class="comment">// 移除其他增益时</span></span><br><span class="line">    AddDebuff = <span class="number">7</span>,      <span class="comment">// 添加其他减益时</span></span><br><span class="line">    RemoveDebuff = <span class="number">8</span>,   <span class="comment">// 移除其他减益时</span></span><br><span class="line">    DeadSelf = <span class="number">9</span>,       <span class="comment">// 自身死亡时</span></span><br><span class="line">    ReviveSelf = <span class="number">10</span>,    <span class="comment">// 自身复活时</span></span><br><span class="line">    DeadAlly = <span class="number">11</span>,      <span class="comment">// 友方死亡时</span></span><br><span class="line">    ReviveAlly = <span class="number">12</span>,    <span class="comment">// 友方复活时</span></span><br><span class="line">    Dead = <span class="number">13</span>,          <span class="comment">// 其他单位死亡时</span></span><br><span class="line">    Revive = <span class="number">14</span>,        <span class="comment">// 其他单位复活时</span></span><br><span class="line">    OnCrit = <span class="number">15</span>,        <span class="comment">// 暴击时</span></span><br><span class="line">    OnCrited = <span class="number">16</span>,      <span class="comment">// 受到暴击时</span></span><br><span class="line">    OnKill = <span class="number">17</span>,        <span class="comment">// 造成击杀时</span></span><br><span class="line">    OnAttack = <span class="number">18</span>,      <span class="comment">// 使用普攻时</span></span><br><span class="line">    BeforeAllyCast = <span class="number">19</span>,<span class="comment">// 友方使用技能前</span></span><br><span class="line">    AfterAllyCast = <span class="number">20</span>, <span class="comment">// 友方使用技能后</span></span><br><span class="line">    BeforeEnemyCast = <span class="number">21</span>,<span class="comment">// 敌方使用技能前</span></span><br><span class="line">    AfterEnemyCast = <span class="number">22</span>,<span class="comment">// 敌方使用技能后</span></span><br><span class="line">    BeforeCast = <span class="number">23</span>,    <span class="comment">// 自身使用技能前</span></span><br><span class="line">    AfterCast = <span class="number">24</span>,     <span class="comment">// 自身使用技能后</span></span><br><span class="line">    GetCost = <span class="number">25</span>,       <span class="comment">// 获得资源时</span></span><br><span class="line">    ConsumeCost = <span class="number">26</span>,   <span class="comment">// 消耗资源时</span></span><br><span class="line">    OnAllyDamaged = <span class="number">27</span>, <span class="comment">// 友方受伤时</span></span><br><span class="line">    OnAllyHeal = <span class="number">28</span>,    <span class="comment">// 友方承受治疗时</span></span><br><span class="line">    OnEnemyDamaged = <span class="number">29</span>,<span class="comment">// 敌方受伤时</span></span><br><span class="line">    OnEnemyHeal = <span class="number">30</span>,   <span class="comment">// 敌方承受治疗时</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> BuffType : <span class="built_in">byte</span></span><br><span class="line">&#123;</span><br><span class="line">    Buff,   <span class="comment">// 正常Buff，可被驱散</span></span><br><span class="line">    Mark,   <span class="comment">// 印记，不可被驱散</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-1-角色定义"><a href="#1-1-角色定义" class="headerlink" title="1.1&#x2F;角色定义"></a>1.1&#x2F;角色定义</h4><p>分析我们先前的系统设计，对于<code>角色</code>，我们大体能得出以下图</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Assets\Scripts\DataDef\RoleData.cs</span></span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">RoleData</span> : <span class="title">ScriptableObject</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 基础属性</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> Hp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> Atk;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> Def;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> Spd;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> Crit;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> CritDmg;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> Hit;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> Res;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 技能配置</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 深拷贝,将Data转换为实际的对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Role <span class="title">ToRole</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 调用对应的函数生成并返回</span></span><br><span class="line">        Role ret = <span class="keyword">new</span> Role(Hp, Atk, Def, Spd, Crit, CritDmg, Hit, Res);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Assets\Scripts\DataDef\Role.cs</span></span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.UI;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 实际的Role</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Role</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Id,只会在战斗中生成</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 基础属性</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> hpMax;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> hp;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> attack;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> defense;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> speed;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> critChance;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> critDamage;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> hitChance;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> resistance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 倍率部分</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> attackRate;        <span class="comment">// 攻击力倍率</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> defenseRate;       <span class="comment">// 防御倍率</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> speedRate;         <span class="comment">// 速度倍率</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> critRate;          <span class="comment">// 暴击机率倍率</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> critDmgRate;       <span class="comment">// 暴击伤害倍率</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> hitRate;           <span class="comment">// 命中倍率</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> resistanceRate;    <span class="comment">// 抵抗倍率</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 固定部分</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> attackExtra;       <span class="comment">// 额外攻击力</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> defenseExtra;      <span class="comment">// 额外防御</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> speedExtra;        <span class="comment">// 额外速度</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> critExtra;         <span class="comment">// 额外暴击机率</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> critDmgExtra;      <span class="comment">// 额外暴击伤害</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> hitExtra;          <span class="comment">// 额外效果命中</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> resistanceExtra;   <span class="comment">// 额外效果抵抗</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Skill&gt; skillList;   <span class="comment">// 角色的技能</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Skill curSkill;          <span class="comment">// 当前回合释放的技能</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Role&gt; targetList;   <span class="comment">// 技能选择的目标</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Role</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 给全数据生成的Role对象</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;hpMax&quot;&gt;</span>初始生命值<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;attack&quot;&gt;</span>攻击力<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;defense&quot;&gt;</span>防御<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;speed&quot;&gt;</span>速度<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;critChance&quot;&gt;</span>暴击几率<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;critDamage&quot;&gt;</span>暴击伤害<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;hitChance&quot;&gt;</span>效果命中<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;resistance&quot;&gt;</span>效果抵抗<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;attackRate&quot;&gt;</span>攻击倍率<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;defenseRate&quot;&gt;</span>防御倍率<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;speedRate&quot;&gt;</span>速度倍率<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;critRate&quot;&gt;</span>暴击机率倍率<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;critDmgRate&quot;&gt;</span>暴击伤害倍率<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;hitRate&quot;&gt;</span>效果命中倍率<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;resistanceRate&quot;&gt;</span>效果抵抗倍率<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;attackExtra&quot;&gt;</span>额外攻击<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;defenseExtra&quot;&gt;</span>额外防御<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;speedExtra&quot;&gt;</span>额外速度<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;critExtra&quot;&gt;</span>额外暴击<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;critDmgExtra&quot;&gt;</span>额外爆伤<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;hitExtra&quot;&gt;</span>额外效果命中<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;resistanceExtra&quot;&gt;</span>额外效果抵抗<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Role</span>(<span class="params"><span class="built_in">float</span> hpMax, <span class="built_in">float</span> attack, <span class="built_in">float</span> defense, <span class="built_in">float</span> speed, <span class="built_in">float</span> critChance, <span class="built_in">float</span> critDamage, <span class="built_in">float</span> hitChance, <span class="built_in">float</span> resistance, <span class="built_in">float</span> attackRate, <span class="built_in">float</span> defenseRate, <span class="built_in">float</span> speedRate, <span class="built_in">float</span> critRate, <span class="built_in">float</span> critDmgRate, <span class="built_in">float</span> hitRate, <span class="built_in">float</span> resistanceRate, <span class="built_in">float</span> attackExtra, <span class="built_in">float</span> defenseExtra, <span class="built_in">float</span> speedExtra, <span class="built_in">float</span> critExtra, <span class="built_in">float</span> critDmgExtra, <span class="built_in">float</span> hitExtra, <span class="built_in">float</span> resistanceExtra</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.hpMax = hpMax;</span><br><span class="line">        <span class="keyword">this</span>.hp = hpMax;</span><br><span class="line">        <span class="keyword">this</span>.attack = attack;</span><br><span class="line">        <span class="keyword">this</span>.defense = defense;</span><br><span class="line">        <span class="keyword">this</span>.speed = speed;</span><br><span class="line">        <span class="keyword">this</span>.critChance = critChance;</span><br><span class="line">        <span class="keyword">this</span>.critDamage = critDamage;</span><br><span class="line">        <span class="keyword">this</span>.hitChance = hitChance;</span><br><span class="line">        <span class="keyword">this</span>.resistance = resistance;</span><br><span class="line">        <span class="keyword">this</span>.attackRate = attackRate;</span><br><span class="line">        <span class="keyword">this</span>.defenseRate = defenseRate;</span><br><span class="line">        <span class="keyword">this</span>.speedRate = speedRate;</span><br><span class="line">        <span class="keyword">this</span>.critRate = critRate;</span><br><span class="line">        <span class="keyword">this</span>.critDmgRate = critDmgRate;</span><br><span class="line">        <span class="keyword">this</span>.hitRate = hitRate;</span><br><span class="line">        <span class="keyword">this</span>.resistanceRate = resistanceRate;</span><br><span class="line">        <span class="keyword">this</span>.attackExtra = attackExtra;</span><br><span class="line">        <span class="keyword">this</span>.defenseExtra = defenseExtra;</span><br><span class="line">        <span class="keyword">this</span>.speedExtra = speedExtra;</span><br><span class="line">        <span class="keyword">this</span>.critExtra = critExtra;</span><br><span class="line">        <span class="keyword">this</span>.critDmgExtra = critDmgExtra;</span><br><span class="line">        <span class="keyword">this</span>.hitExtra = hitExtra;</span><br><span class="line">        <span class="keyword">this</span>.resistanceExtra = resistanceExtra;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 只有初始数据生成的Role对象</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;hpMax&quot;&gt;</span>初始生命<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;attack&quot;&gt;</span>攻击力<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;defense&quot;&gt;</span>防御<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;speed&quot;&gt;</span>速度<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;critChance&quot;&gt;</span>暴击几率<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;critDamage&quot;&gt;</span>暴击伤害<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;hitChance&quot;&gt;</span>效果命中<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;resistance&quot;&gt;</span>效果抵抗<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Role</span>(<span class="params"><span class="built_in">float</span> hpMax, <span class="built_in">float</span> attack, <span class="built_in">float</span> defense, <span class="built_in">float</span> speed, <span class="built_in">float</span> critChance, <span class="built_in">float</span> critDamage, <span class="built_in">float</span> hitChance, <span class="built_in">float</span> resistance</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.hpMax = hpMax;</span><br><span class="line">        <span class="keyword">this</span>.hp = hpMax;</span><br><span class="line">        <span class="keyword">this</span>.attack = attack;</span><br><span class="line">        <span class="keyword">this</span>.defense = defense;</span><br><span class="line">        <span class="keyword">this</span>.speed = speed;</span><br><span class="line">        <span class="keyword">this</span>.critChance = critChance;</span><br><span class="line">        <span class="keyword">this</span>.critDamage = critDamage;</span><br><span class="line">        <span class="keyword">this</span>.hitChance = hitChance;</span><br><span class="line">        <span class="keyword">this</span>.resistance = resistance;</span><br><span class="line">        <span class="keyword">this</span>.attackRate = <span class="number">0f</span>;</span><br><span class="line">        <span class="keyword">this</span>.defenseRate = <span class="number">0f</span>;</span><br><span class="line">        <span class="keyword">this</span>.speedRate = <span class="number">0f</span>;</span><br><span class="line">        <span class="keyword">this</span>.critRate = <span class="number">0f</span>;</span><br><span class="line">        <span class="keyword">this</span>.critDmgRate = <span class="number">0f</span>;</span><br><span class="line">        <span class="keyword">this</span>.hitRate = <span class="number">0f</span>;</span><br><span class="line">        <span class="keyword">this</span>.resistanceRate = <span class="number">0f</span>;</span><br><span class="line">        <span class="keyword">this</span>.attackExtra = <span class="number">0f</span>;</span><br><span class="line">        <span class="keyword">this</span>.defenseExtra = <span class="number">0f</span>;</span><br><span class="line">        <span class="keyword">this</span>.speedExtra = <span class="number">0f</span>;</span><br><span class="line">        <span class="keyword">this</span>.critExtra = <span class="number">0f</span>;</span><br><span class="line">        <span class="keyword">this</span>.critDmgExtra = <span class="number">0f</span>;</span><br><span class="line">        <span class="keyword">this</span>.hitExtra = <span class="number">0f</span>;</span><br><span class="line">        <span class="keyword">this</span>.resistanceExtra = <span class="number">0f</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="keyword">region</span> 角色的行为</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 释放当前回合选择的技能</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>是否成功释放<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">CastCurSkill</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        curSkill.Cast(<span class="keyword">this</span>, targetList);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="keyword">region</span> 获取计算好的属性</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取计算好的速度</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">float</span> <span class="title">GetSpeed</span>()</span> &#123; <span class="keyword">return</span> (<span class="keyword">this</span>.speed + <span class="keyword">this</span>.speedExtra) * (<span class="number">1f</span> + <span class="keyword">this</span>.speedRate); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="1-2-技能定义"><a href="#1-2-技能定义" class="headerlink" title="1.2&#x2F;技能定义"></a>1.2&#x2F;技能定义</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SkillData</span> : <span class="title">ScriptableObject</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Skill</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Cast</span>(<span class="params">Role caster, List&lt;Role&gt; targets</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="1-3-Buff定义"><a href="#1-3-Buff定义" class="headerlink" title="1.3&#x2F;Buff定义"></a>1.3&#x2F;Buff定义</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BuffData</span> : <span class="title">ScriptableObject</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> buffName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> description;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> BuffTime triggerTime;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Buff</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="1-4-行动条管理"><a href="#1-4-行动条管理" class="headerlink" title="1.4&#x2F;行动条管理"></a>1.4&#x2F;行动条管理</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 将行动条单独封装成一个类,好操作</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ActStrip</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 在场的所有单位</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;ActUnit&gt; allUnits;</span><br><span class="line">    <span class="comment">// 行动条上的所有单位</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;ActUnit&gt; units;</span><br><span class="line">    <span class="comment">// 行动条的长度,由一速决定</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">float</span> actLength;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ActStrip</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.allUnits = <span class="keyword">new</span> List&lt;ActUnit&gt;();</span><br><span class="line">        <span class="keyword">this</span>.units = <span class="keyword">new</span> List&lt;ActUnit&gt;();</span><br><span class="line">        <span class="keyword">this</span>.actLength = <span class="number">0f</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 根据给定角色生成行动队列</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;roles&quot;&gt;</span>参与战斗的角色<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GenerateActStrip</span>(<span class="params">List&lt;Role&gt; roles</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">float</span> tempSpeed = <span class="number">0f</span>;   <span class="comment">// 最快一速</span></span><br><span class="line">        <span class="keyword">foreach</span> (Role role <span class="keyword">in</span> roles)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(role.speed &gt; tempSpeed)</span><br><span class="line">                tempSpeed = role.speed;</span><br><span class="line">            <span class="keyword">this</span>.allUnits.Add(<span class="keyword">new</span> ActUnit(role));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.actLength = tempSpeed;</span><br><span class="line">        <span class="comment">// 根据curProgress排序</span></span><br><span class="line">        <span class="keyword">this</span>.allUnits.Sort((ActUnit x, ActUnit y) =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            Role roleX = BattleManager.GetRoleById(x.roleId);</span><br><span class="line">            Role roleY = BattleManager.GetRoleById(y.roleId);</span><br><span class="line">            <span class="keyword">return</span> roleX.speed.CompareTo(roleY.speed);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">this</span>.units = allUnits;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 行动至下一个角色并返回它</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>行动条推进后进行行动的角色<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Role <span class="title">ActProgress</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 只用看行动条的第一个就知道整体的情况了</span></span><br><span class="line">        ActUnit unit = <span class="keyword">this</span>.units[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span> (unit.curProgress &gt;= actLength)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 复制一份到队尾,删除unit并返回这个角色</span></span><br><span class="line">            unit.Duplicate(unit.curProgress - actLength);</span><br><span class="line">            Role ret = BattleManager.GetRoleById(unit.roleId);</span><br><span class="line">            units.Remove(unit);</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 所有人都按照自己的速度行动</span></span><br><span class="line">            <span class="keyword">foreach</span>(ActUnit u <span class="keyword">in</span> units)</span><br><span class="line">            &#123;</span><br><span class="line">                Role role = BattleManager.GetRoleById(u.roleId);</span><br><span class="line">                <span class="keyword">if</span>(role != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    u.curProgress += role.GetSpeed();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 行动完递归调用一次</span></span><br><span class="line">            <span class="keyword">return</span> ActProgress();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ActUnit</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 在本场战斗中的唯一Id</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> roleId = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 当前位于行动条的哪个位置</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> curProgress;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ActUnit</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.roleId = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.curProgress = <span class="number">0f</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始生成角色</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ActUnit</span>(<span class="params">Role role</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 读取角色的Id</span></span><br><span class="line">        <span class="keyword">this</span>.roleId = role.Id;</span><br><span class="line">        <span class="keyword">this</span>.curProgress = role.speed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成同一个单位的不同速度副本</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ActUnit <span class="title">Duplicate</span>(<span class="params"><span class="built_in">float</span> extraProgress</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.roleId == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.LogError(<span class="string">&quot;复制了一个空目标&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.curProgress = extraProgress;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="1-5-战斗管理器"><a href="#1-5-战斗管理器" class="headerlink" title="1.5&#x2F;战斗管理器"></a>1.5&#x2F;战斗管理器</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Assets\Scripts\System\Battle\BattleManager.cs</span></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BattleManager</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 所有的等待都用这个来实现</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> WaitForSeconds _delaySeconds = <span class="keyword">new</span> WaitForSeconds(<span class="number">0.3f</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="keyword">region</span> 战斗相关数据</span></span><br><span class="line">    <span class="comment">// 存放用来深拷贝的双方数据</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 玩家队伍的角色数据</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    List&lt;RoleData&gt; playerTeam;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 敌方队伍的角色数据</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    List&lt;RoleData&gt; enemyTeam;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 玩家队伍的角色</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Role&gt; playerRoles;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 敌方队伍的角色</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Role&gt; enemyRoles;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 当前回合正在行动的角色</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    Role curActRole;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 当前的行动队列和之后的行动队列</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    ActStrip actStrip;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 当前战斗的状态</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> BattleState _battleState;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Start</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        StartCoroutine(Fight(() =&gt; &#123; Debug.Log(<span class="string">&quot;战斗胜利&quot;</span>); &#125;, () =&gt; &#123; Debug.Log(<span class="string">&quot;战斗失败&quot;</span>); &#125;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">IEnumerator <span class="title">Fight</span>(<span class="params">Action winCallback, Action loseCallback</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 从这里开始就是进入战斗逻辑的初始化部分</span></span><br><span class="line">        <span class="keyword">foreach</span>(RoleData playerData <span class="keyword">in</span> playerTeam)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 初始化玩家阵营的人物</span></span><br><span class="line">            playerRoles.Add(playerData.ToRole());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">foreach</span> (RoleData enemyData <span class="keyword">in</span> enemyTeam)</span><br><span class="line">        &#123;</span><br><span class="line">            enemyRoles.Add(enemyData.ToRole());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 读取所有单位的速度,初始化行动条</span></span><br><span class="line">        actStrip.GenerateActStrip(playerRoles.Concat(enemyRoles).ToList());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 初始化战斗结果</span></span><br><span class="line">        <span class="built_in">int</span> result = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 战斗主循环</span></span><br><span class="line">        <span class="keyword">while</span> ((<span class="built_in">int</span>)_battleState &lt; <span class="number">5</span> )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 处理先机事件,只有刚进入战斗会触发</span></span><br><span class="line">            <span class="keyword">if</span> (_battleState == BattleState.Enter)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// <span class="doctag">TODO:</span>遍历单位的先机相关属性</span></span><br><span class="line">                Debug.Log(<span class="string">&quot;触发了所有人的先机效果&quot;</span>);</span><br><span class="line">                <span class="keyword">while</span>(_battleState == BattleState.Acting) &#123; <span class="keyword">yield</span> <span class="keyword">return</span> _delaySeconds; &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            result = CheckBattleResult();</span><br><span class="line">            <span class="keyword">if</span>(result == <span class="number">1</span>) &#123;<span class="keyword">yield</span> <span class="keyword">return</span> winCallback; &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(result == <span class="number">2</span>) &#123; <span class="keyword">yield</span> <span class="keyword">return</span> loseCallback; &#125;</span><br><span class="line"></span><br><span class="line">            curActRole = actStrip.ActProgress();</span><br><span class="line">            _battleState = BattleState.BeforeAct;</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> 回合前BUFF检测</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(playerRoles.Contains(curActRole) &amp;&amp; _battleState == BattleState.BeforeAct)</span><br><span class="line">            &#123;</span><br><span class="line">                _battleState = BattleState.SelectAct;</span><br><span class="line">                <span class="comment">// 等待玩家操作</span></span><br><span class="line">                <span class="keyword">while</span>(_battleState == BattleState.SelectAct) &#123; <span class="keyword">yield</span> <span class="keyword">return</span> _delaySeconds; &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(enemyRoles.Contains(curActRole) &amp;&amp; _battleState == BattleState.BeforeAct)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// <span class="doctag">TODO:</span> 调用敌人的AI选择技能</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 技能演出</span></span><br><span class="line">            <span class="keyword">if</span>(curActRole.curSkill != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                curActRole.CastCurSkill();</span><br><span class="line">                <span class="keyword">while</span>(_battleState == BattleState.Acting) &#123; <span class="keyword">yield</span> <span class="keyword">return</span> _delaySeconds; &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            _battleState = BattleState.AfterAct;</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> 行动后的逻辑</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 判断是否满足结束条件</span></span><br><span class="line">            result = CheckBattleResult();</span><br><span class="line">            <span class="keyword">if</span> (result == <span class="number">1</span>) &#123; <span class="keyword">yield</span> <span class="keyword">return</span> winCallback; &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (result == <span class="number">2</span>) &#123; <span class="keyword">yield</span> <span class="keyword">return</span> loseCallback; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 检查当前是否满足结束条件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>0 - 还没结束，1 - 胜利，2 - 失败<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">CheckBattleResult</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 玩家阵营全部阵亡 -- 失败</span></span><br><span class="line">        <span class="keyword">if</span>(playerRoles.Count == <span class="number">0</span>) &#123; <span class="keyword">return</span> <span class="number">2</span>; &#125;</span><br><span class="line">        <span class="comment">// 敌方阵营全部阵亡 -- 胜利</span></span><br><span class="line">        <span class="keyword">if</span>(enemyRoles.Count == <span class="number">0</span>) &#123; <span class="keyword">return</span> <span class="number">1</span>; &#125;</span><br><span class="line">        <span class="comment">// 否则就是还没结束</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="keyword">region</span> 外界获取数据的接口</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 根据角色的Id获取角色对象</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Id&quot;&gt;</span>角色的Id<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>成功返回角色对象,失败返回null<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Role <span class="title">GetRoleById</span>(<span class="params"><span class="built_in">int</span> Id</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">foreach</span> (Role role <span class="keyword">in</span> playerRoles)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (role.Id == Id)&#123; <span class="keyword">return</span> role; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">foreach</span>(Role role <span class="keyword">in</span> enemyRoles)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (role.Id == Id) &#123; <span class="keyword">return</span> role; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">从最简单的回合制逻辑开始</summary>
    
    
    
    <category term="RE:从0开始的RPG游戏制作" scheme="https://mralridge.github.io/categories/RE-%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84RPG%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C/"/>
    
    
    <category term="Unity3D" scheme="https://mralridge.github.io/tags/Unity3D/"/>
    
    <category term="游戏开发" scheme="https://mralridge.github.io/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/"/>
    
    <category term="玩法设计" scheme="https://mralridge.github.io/tags/%E7%8E%A9%E6%B3%95%E8%AE%BE%E8%AE%A1/"/>
    
    <category term="C#" scheme="https://mralridge.github.io/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>(0) 准备阶段 - RE:从0开始的RPG游戏制作</title>
    <link href="https://mralridge.github.io/2024/06/26/RE-%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84RPG%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C/"/>
    <id>https://mralridge.github.io/2024/06/26/RE-%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84RPG%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C/</id>
    <published>2024-06-26T06:57:38.000Z</published>
    <updated>2024-06-27T09:48:01.197Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0-序言"><a href="#0-序言" class="headerlink" title="0&#x2F;序言"></a>0&#x2F;序言</h3><p>说起来Unity3D学了这么长时间，还没认真做过什么东西，既然目前的工作与回合制RPG游戏有重合，并且这一年多也玩了不少JRPG之类的回合制游戏，暂且就先试试看吧。</p><p>这个系列不只是只有编程方面的教学，我会试着尽量以制作人的角度来考虑各种问题，同时这也是我自己项目的一个开发历程。</p><h3 id="1-项目策划"><a href="#1-项目策划" class="headerlink" title="1&#x2F;项目策划"></a>1&#x2F;项目策划</h3><p>这个项目我就准备仿照阴阳师来做了</p>]]></content>
    
    
    <summary type="html">或许这一次能够真真正正的做到最后</summary>
    
    
    
    <category term="RE:从0开始的RPG游戏制作" scheme="https://mralridge.github.io/categories/RE-%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84RPG%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C/"/>
    
    
    <category term="Unity3D" scheme="https://mralridge.github.io/tags/Unity3D/"/>
    
    <category term="游戏开发" scheme="https://mralridge.github.io/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/"/>
    
    <category term="玩法设计" scheme="https://mralridge.github.io/tags/%E7%8E%A9%E6%B3%95%E8%AE%BE%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>半个小时之后如何更新你的博客</title>
    <link href="https://mralridge.github.io/2024/06/26/%E5%8D%8A%E4%B8%AA%E5%B0%8F%E6%97%B6%E4%B9%8B%E5%90%8E%E5%A6%82%E4%BD%95%E6%9B%B4%E6%96%B0%E4%BD%A0%E7%9A%84%E5%8D%9A%E5%AE%A2/"/>
    <id>https://mralridge.github.io/2024/06/26/%E5%8D%8A%E4%B8%AA%E5%B0%8F%E6%97%B6%E4%B9%8B%E5%90%8E%E5%A6%82%E4%BD%95%E6%9B%B4%E6%96%B0%E4%BD%A0%E7%9A%84%E5%8D%9A%E5%AE%A2/</id>
    <published>2024-06-26T02:13:22.000Z</published>
    <updated>2024-06-28T08:58:38.591Z</updated>
    
    <content type="html"><![CDATA[<p>在上一章,我们已经完成了博客的搭建,这一章就是博客的日常操作</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在上一章,我们已经完成了博客的搭建,这一章就是博客的日常操作&lt;/p&gt;
</summary>
      
    
    
    
    <category term="很简单的Hexo建站教程" scheme="https://mralridge.github.io/categories/%E5%BE%88%E7%AE%80%E5%8D%95%E7%9A%84Hexo%E5%BB%BA%E7%AB%99%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="Hexo" scheme="https://mralridge.github.io/tags/Hexo/"/>
    
    <category term="杂项" scheme="https://mralridge.github.io/tags/%E6%9D%82%E9%A1%B9/"/>
    
  </entry>
  
  <entry>
    <title>记一个pairs迭代器的坑</title>
    <link href="https://mralridge.github.io/2024/06/25/%E8%AE%B0%E4%B8%80%E4%B8%AApairs%E8%BF%AD%E4%BB%A3%E5%99%A8%E7%9A%84%E5%9D%91/"/>
    <id>https://mralridge.github.io/2024/06/25/%E8%AE%B0%E4%B8%80%E4%B8%AApairs%E8%BF%AD%E4%BB%A3%E5%99%A8%E7%9A%84%E5%9D%91/</id>
    <published>2024-06-25T01:48:14.000Z</published>
    <updated>2024-06-28T08:59:54.197Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0-碎碎念"><a href="#0-碎碎念" class="headerlink" title="0&#x2F;碎碎念"></a>0&#x2F;碎碎念</h3><p>由于目前的项目采用的战利品掉落被我设计成每个地图都不一样,之前的功能已经做了每个地图对应的战利品表了,处于方便维护的考虑,这次新增的战利品表也要每个地图都做一个.但是每个表涉及的战利品都非常的多,所以我就想先把所有的表用字符串输出出来再手动复制过去,毕竟这些表只有概率字段是会变的.</p><h3 id="1-第一次尝试"><a href="#1-第一次尝试" class="headerlink" title="1&#x2F;第一次尝试"></a>1&#x2F;第一次尝试</h3><p>所以我就写了下面这个代码来生成每层的表</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> <span class="built_in">format</span> = <span class="string">[[</span></span><br><span class="line"><span class="string">[3] = &#123;</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;nil&quot;, Num = 1, Bind = 1, Rand=&#123;BASE&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品1&quot;, Num = 1, Bind = 1, Rand=&#123;RAND1&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品2&quot;, Num = 1, Bind = 1, Rand=&#123;RAND2&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品3&quot;, Num = 1, Bind = 1, Rand=&#123;RAND3&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品4&quot;, Num = 1, Bind = 1, Rand=&#123;RAND4&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品5&quot;, Num = 1, Bind = 1, Rand=&#123;RAND5&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品6&quot;, Num = 1, Bind = 1, Rand=&#123;RAND6&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品7&quot;, Num = 3, Bind = 1, Rand=&#123;RAND7&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品8&quot;, Num = 1, Bind = 1, Rand=&#123;RAND8&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品9&quot;, Num = 3, Bind = 1, Rand=&#123;RAND9&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品10&quot;, Num = 5, Bind = 1, Rand=&#123;RAND10&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品11&quot;, Num = 1, Bind = 1, Rand=&#123;RAND11&#125;&#125;,</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">]]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> baseRand = <span class="number">5000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> otherRand = &#123;</span><br><span class="line">    <span class="number">30</span>,<span class="number">40</span>,<span class="number">90</span>,<span class="number">40</span>,<span class="number">25</span>,<span class="number">25</span>,<span class="number">90</span>,<span class="number">90</span>,<span class="number">40</span>,<span class="number">25</span>,<span class="number">5</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, <span class="number">36</span> <span class="keyword">do</span></span><br><span class="line"><span class="keyword">if</span> i ~= <span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">        baseRand = baseRand - <span class="number">11</span></span><br><span class="line">        <span class="keyword">for</span> index, value <span class="keyword">in</span> <span class="built_in">ipairs</span>(otherRand) <span class="keyword">do</span></span><br><span class="line">            value = value + <span class="number">1</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">local</span> tmpStr = <span class="built_in">string</span>.<span class="built_in">gsub</span>(<span class="built_in">format</span>, <span class="string">&quot;&#123;BASE&#125;&quot;</span>, baseRand)</span><br><span class="line">    <span class="keyword">for</span> index, value <span class="keyword">in</span> <span class="built_in">ipairs</span>(otherRand) <span class="keyword">do</span></span><br><span class="line">        tmpStr = <span class="built_in">string</span>.<span class="built_in">gsub</span>(tmpStr, <span class="string">&quot;&#123;RAND&quot;</span>..<span class="built_in">tostring</span>(index)..<span class="string">&quot;&#125;&quot;</span>, value)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="built_in">print</span>(tmpStr)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>然而得到的运行结果却是这样的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">[3] = &#123;</span><br><span class="line">        &#123;ItemKey=&quot;nil&quot;, Num = 1, Bind = 1, Rand=5000&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品1&quot;, Num = 1, Bind = 1, Rand=30&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品2&quot;, Num = 1, Bind = 1, Rand=40&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品3&quot;, Num = 1, Bind = 1, Rand=90&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品4&quot;, Num = 1, Bind = 1, Rand=40&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品5&quot;, Num = 1, Bind = 1, Rand=25&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品6&quot;, Num = 1, Bind = 1, Rand=25&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品7&quot;, Num = 3, Bind = 1, Rand=90&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品8&quot;, Num = 1, Bind = 1, Rand=90&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品9&quot;, Num = 3, Bind = 1, Rand=40&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品10&quot;, Num = 5, Bind = 1, Rand=25&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品11&quot;, Num = 1, Bind = 1, Rand=5&#125;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">        [3] = &#123;</span><br><span class="line">        &#123;ItemKey=&quot;nil&quot;, Num = 1, Bind = 1, Rand=4989&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品1&quot;, Num = 1, Bind = 1, Rand=30&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品2&quot;, Num = 1, Bind = 1, Rand=40&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品3&quot;, Num = 1, Bind = 1, Rand=90&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品4&quot;, Num = 1, Bind = 1, Rand=40&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品5&quot;, Num = 1, Bind = 1, Rand=25&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品6&quot;, Num = 1, Bind = 1, Rand=25&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品7&quot;, Num = 3, Bind = 1, Rand=90&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品8&quot;, Num = 1, Bind = 1, Rand=90&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品9&quot;, Num = 3, Bind = 1, Rand=40&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品10&quot;, Num = 5, Bind = 1, Rand=25&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品11&quot;, Num = 1, Bind = 1, Rand=5&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    &lt;...&gt;</span><br><span class="line">        [3] = &#123;</span><br><span class="line">        &#123;ItemKey=&quot;nil&quot;, Num = 1, Bind = 1, Rand=4615&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品1&quot;, Num = 1, Bind = 1, Rand=30&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品2&quot;, Num = 1, Bind = 1, Rand=40&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品3&quot;, Num = 1, Bind = 1, Rand=90&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品4&quot;, Num = 1, Bind = 1, Rand=40&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品5&quot;, Num = 1, Bind = 1, Rand=25&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品6&quot;, Num = 1, Bind = 1, Rand=25&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品7&quot;, Num = 3, Bind = 1, Rand=90&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品8&quot;, Num = 1, Bind = 1, Rand=90&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品9&quot;, Num = 3, Bind = 1, Rand=40&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品10&quot;, Num = 5, Bind = 1, Rand=25&#125;,</span><br><span class="line">        &#123;ItemKey=&quot;物品11&quot;, Num = 1, Bind = 1, Rand=5&#125;,</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>可以看到除了第一个nil物品的概率发生了改变,其他的都没有变化.翻来覆去看了5分钟,发现问题出在这里</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> index, value <span class="keyword">in</span> <span class="built_in">ipairs</span>(otherRand) <span class="keyword">do</span></span><br><span class="line">    value = value + <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>这里我直接修改了迭代器返回的对象,但是调试的过程中发现,<code>index</code>和<code>value</code>都只是迭代器返回的一个值,而不是对表中元素的引用,所以这里的修改并不会改变表中的值.</p><h3 id="2-第二次尝试"><a href="#2-第二次尝试" class="headerlink" title="2&#x2F;第二次尝试"></a>2&#x2F;第二次尝试</h3><p>修改成以下代码就可以了</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> <span class="built_in">format</span> = <span class="string">[[</span></span><br><span class="line"><span class="string">[3] = &#123;</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;nil&quot;, Num = 1, Bind = 1, Rand=&#123;BASE&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品1&quot;, Num = 1, Bind = 1, Rand=&#123;RAND1&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品2&quot;, Num = 1, Bind = 1, Rand=&#123;RAND2&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品3&quot;, Num = 1, Bind = 1, Rand=&#123;RAND3&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品4&quot;, Num = 1, Bind = 1, Rand=&#123;RAND4&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品5&quot;, Num = 1, Bind = 1, Rand=&#123;RAND5&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品6&quot;, Num = 1, Bind = 1, Rand=&#123;RAND6&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品7&quot;, Num = 3, Bind = 1, Rand=&#123;RAND7&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品8&quot;, Num = 1, Bind = 1, Rand=&#123;RAND8&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品9&quot;, Num = 3, Bind = 1, Rand=&#123;RAND9&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品10&quot;, Num = 5, Bind = 1, Rand=&#123;RAND10&#125;&#125;,</span></span><br><span class="line"><span class="string">        &#123;ItemKey=&quot;物品11&quot;, Num = 1, Bind = 1, Rand=&#123;RAND11&#125;&#125;,</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">]]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> baseRand = <span class="number">5000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> otherRand = &#123;</span><br><span class="line">    <span class="number">30</span>,<span class="number">40</span>,<span class="number">90</span>,<span class="number">40</span>,<span class="number">25</span>,<span class="number">25</span>,<span class="number">90</span>,<span class="number">90</span>,<span class="number">40</span>,<span class="number">25</span>,<span class="number">5</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, <span class="number">36</span> <span class="keyword">do</span></span><br><span class="line"><span class="keyword">if</span> i ~= <span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">        baseRand = baseRand - <span class="number">11</span></span><br><span class="line">        <span class="keyword">for</span> index, value <span class="keyword">in</span> <span class="built_in">ipairs</span>(otherRand) <span class="keyword">do</span></span><br><span class="line">            otherRand[index] = value + <span class="number">1</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">local</span> tmpStr = <span class="built_in">string</span>.<span class="built_in">gsub</span>(<span class="built_in">format</span>, <span class="string">&quot;&#123;BASE&#125;&quot;</span>, baseRand)</span><br><span class="line">    <span class="keyword">for</span> index, value <span class="keyword">in</span> <span class="built_in">ipairs</span>(otherRand) <span class="keyword">do</span></span><br><span class="line">        tmpStr = <span class="built_in">string</span>.<span class="built_in">gsub</span>(tmpStr, <span class="string">&quot;&#123;RAND&quot;</span>..<span class="built_in">tostring</span>(index)..<span class="string">&quot;&#125;&quot;</span>, value)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="built_in">print</span>(tmpStr)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>运行结果如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">[3] = &#123;</span><br><span class="line">    &#123;ItemKey=&quot;nil&quot;, Num = 1, Bind = 1, Rand=5000&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品1&quot;, Num = 1, Bind = 1, Rand=30&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品2&quot;, Num = 1, Bind = 1, Rand=40&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品3&quot;, Num = 1, Bind = 1, Rand=90&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品4&quot;, Num = 1, Bind = 1, Rand=40&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品5&quot;, Num = 1, Bind = 1, Rand=25&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品6&quot;, Num = 1, Bind = 1, Rand=25&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品7&quot;, Num = 3, Bind = 1, Rand=90&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品8&quot;, Num = 1, Bind = 1, Rand=90&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品9&quot;, Num = 3, Bind = 1, Rand=40&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品10&quot;, Num = 5, Bind = 1, Rand=25&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品11&quot;, Num = 1, Bind = 1, Rand=5&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[3] = &#123;</span><br><span class="line">    &#123;ItemKey=&quot;nil&quot;, Num = 1, Bind = 1, Rand=4989&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品1&quot;, Num = 1, Bind = 1, Rand=31&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品2&quot;, Num = 1, Bind = 1, Rand=41&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品3&quot;, Num = 1, Bind = 1, Rand=91&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品4&quot;, Num = 1, Bind = 1, Rand=41&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品5&quot;, Num = 1, Bind = 1, Rand=26&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品6&quot;, Num = 1, Bind = 1, Rand=26&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品7&quot;, Num = 3, Bind = 1, Rand=91&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品8&quot;, Num = 1, Bind = 1, Rand=91&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品9&quot;, Num = 3, Bind = 1, Rand=41&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品10&quot;, Num = 5, Bind = 1, Rand=26&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品11&quot;, Num = 1, Bind = 1, Rand=6&#125;,</span><br><span class="line">&#125;</span><br><span class="line">    &lt;...&gt;</span><br><span class="line">[3] = &#123;</span><br><span class="line">    &#123;ItemKey=&quot;nil&quot;, Num = 1, Bind = 1, Rand=4615&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品1&quot;, Num = 1, Bind = 1, Rand=65&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品2&quot;, Num = 1, Bind = 1, Rand=75&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品3&quot;, Num = 1, Bind = 1, Rand=125&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品4&quot;, Num = 1, Bind = 1, Rand=75&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品5&quot;, Num = 1, Bind = 1, Rand=60&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品6&quot;, Num = 1, Bind = 1, Rand=60&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品7&quot;, Num = 3, Bind = 1, Rand=125&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品8&quot;, Num = 1, Bind = 1, Rand=125&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品9&quot;, Num = 3, Bind = 1, Rand=75&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品10&quot;, Num = 5, Bind = 1, Rand=60&#125;,</span><br><span class="line">    &#123;ItemKey=&quot;物品11&quot;, Num = 1, Bind = 1, Rand=40&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到,<code>otherRand</code>表中的数值也正常地发生了改变</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;0-碎碎念&quot;&gt;&lt;a href=&quot;#0-碎碎念&quot; class=&quot;headerlink&quot; title=&quot;0&amp;#x2F;碎碎念&quot;&gt;&lt;/a&gt;0&amp;#x2F;碎碎念&lt;/h3&gt;&lt;p&gt;由于目前的项目采用的战利品掉落被我设计成每个地图都不一样,之前的功能已经做了每个地图对应的战利品</summary>
      
    
    
    
    <category term="工作经验" scheme="https://mralridge.github.io/categories/%E5%B7%A5%E4%BD%9C%E7%BB%8F%E9%AA%8C/"/>
    
    
    <category term="Lua" scheme="https://mralridge.github.io/tags/Lua/"/>
    
    <category term="踩坑" scheme="https://mralridge.github.io/tags/%E8%B8%A9%E5%9D%91/"/>
    
  </entry>
  
  <entry>
    <title>浅入浅出游戏引擎笔记（一）</title>
    <link href="https://mralridge.github.io/2024/06/24/%E6%B5%85%E5%85%A5%E6%B5%85%E5%87%BA%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <id>https://mralridge.github.io/2024/06/24/%E6%B5%85%E5%85%A5%E6%B5%85%E5%87%BA%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/</id>
    <published>2024-06-24T06:14:45.000Z</published>
    <updated>2024-06-29T07:26:58.194Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0-openGL环境搭建"><a href="#0-openGL环境搭建" class="headerlink" title="0&#x2F;openGL环境搭建"></a>0&#x2F;openGL环境搭建</h3><p>在【从0开始手搓游戏引擎】系列里面，图形API是自己手动调用的，刚开始Windows窗体和DX11还好，到了openGL真的就是噩梦，虽然说openGL的跨平台做的非常好，但是作为初学者上来就接触这么多代码还是有点发怵。索性可以通过glfw可以通过几行代码生成整个OpenGL环境，果然学一门东西还是要从简单的开始入手，没有几个人能够撑下来“这是攻击，这是防御，这是大树守卫环节”。</p><p>下面是涉及到的代码，我尽量用我的理解写下来</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;glad/gl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GLFW_INCLUDE_NONE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;GLFW/glfw3.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    GLFWwindow* window;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 初始化glfw */</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">glfwInit</span>())</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 创建一个Window 和 OpenGL上下文 */</span></span><br><span class="line">    window = <span class="built_in">glfwCreateWindow</span>(<span class="number">960</span>, <span class="number">640</span>, <span class="string">&quot;Hello World&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">if</span> (!window)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//创建失败就退出</span></span><br><span class="line">        <span class="built_in">glfwTerminate</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 激活上面创建的OpenGL上下文 */</span></span><br><span class="line">    <span class="built_in">glfwMakeContextCurrent</span>(window);</span><br><span class="line">    <span class="built_in">gladLoadGL</span>(glfwGetProcAddress);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 进入游戏引擎主循环 */</span></span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">glfwWindowShouldClose</span>(window))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* Render here */</span></span><br><span class="line">        <span class="built_in">glClear</span>(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT);</span><br><span class="line">        <span class="built_in">glClearColor</span>(<span class="number">49.f</span>/<span class="number">255</span>,<span class="number">77.f</span>/<span class="number">255</span>,<span class="number">121.f</span>/<span class="number">255</span>,<span class="number">1.f</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Swap front and back buffers */</span></span><br><span class="line">        <span class="built_in">glfwSwapBuffers</span>(window);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 处理鼠标 键盘事件 */</span></span><br><span class="line">        <span class="built_in">glfwPollEvents</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">glfwTerminate</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>大体表述的处理流程就是下面这样：</p><p><img src="https://www.thisisgame.com.cn/md/cpp-game-engine-book/imgs/opengl_dev_env/dev_env_configure/opengl_flow.jpg" alt="基本流程"></p><h3 id="1-绘制图形"><a href="#1-绘制图形" class="headerlink" title="1&#x2F;绘制图形"></a>1&#x2F;绘制图形</h3><table><thead><tr><th align="center">文件名称</th><th align="center">文件描述</th></tr></thead><tbody><tr><td align="center">main.cpp</td><td align="center">主逻辑</td></tr><tr><td align="center">VertexData.h</td><td align="center">顶点数据(坐标、颜色)</td></tr><tr><td align="center">ShaderSource.h</td><td align="center">Shader代码(顶点Shader和片段Shader)</td></tr></tbody></table><p><code>VertexData.h</code>用来存放需要绘制的三角形相关顶点数据</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> UNTITLED_VERTEXDATA_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UNTITLED_VERTEXDATA_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;glm/glm.hpp&gt;</span></span></span><br><span class="line"><span class="comment">// 顶点的坐标信息</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> glm::vec3 kPositions[<span class="number">3</span>] = &#123;</span><br><span class="line">        glm::vec3&#123; <span class="number">-1.0f</span>, <span class="number">-1.0f</span>,<span class="number">0.0f</span>&#125;,</span><br><span class="line">        glm::vec3&#123;  <span class="number">1.0f</span>, <span class="number">-1.0f</span>,<span class="number">0.0f</span>&#125;,</span><br><span class="line">        glm::vec3&#123;   <span class="number">0.f</span>,  <span class="number">1.0f</span>,<span class="number">0.0f</span>&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 顶点的颜色信息</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> glm::vec4 kColors[<span class="number">3</span>] = &#123;</span><br><span class="line">        glm::vec4&#123; <span class="number">1.f</span>, <span class="number">0.f</span>, <span class="number">0.f</span> ,<span class="number">1.f</span>&#125;,</span><br><span class="line">        glm::vec4&#123; <span class="number">0.f</span>, <span class="number">1.f</span>, <span class="number">0.f</span> ,<span class="number">1.f</span>&#125;,</span><br><span class="line">        glm::vec4&#123; <span class="number">0.f</span>, <span class="number">0.f</span>, <span class="number">1.f</span> ,<span class="number">1.f</span>&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">//UNTITLED_VERTEXDATA_H</span></span></span><br></pre></td></tr></table></figure><p>然后是着色器的代码，由于本人对着色器仍然处于一知半解的状态，所以就只贴代码.大体来说就是告诉显卡顶点该怎么绘制，顶点间的片段该怎么绘制</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by captain on 2021/3/25.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> UNTITLED_SHADERSOURCE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UNTITLED_SHADERSOURCE_H</span></span><br><span class="line"><span class="comment">//顶点着色器代码</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">char</span>* vertex_shader_text =</span><br><span class="line">        <span class="string">&quot;#version 110\n&quot;</span></span><br><span class="line">        <span class="string">&quot;uniform mat4 u_mvp;\n&quot;</span></span><br><span class="line">        <span class="string">&quot;attribute  vec3 a_pos;\n&quot;</span></span><br><span class="line">        <span class="string">&quot;attribute  vec4 a_color;\n&quot;</span></span><br><span class="line">        <span class="string">&quot;varying vec4 v_color;\n&quot;</span></span><br><span class="line">        <span class="string">&quot;void main()\n&quot;</span></span><br><span class="line">        <span class="string">&quot;&#123;\n&quot;</span></span><br><span class="line">        <span class="string">&quot;    gl_Position = u_mvp * vec4(a_pos, 1.0);\n&quot;</span></span><br><span class="line">        <span class="string">&quot;    v_color = a_color;\n&quot;</span></span><br><span class="line">        <span class="string">&quot;&#125;\n&quot;</span>;</span><br><span class="line"><span class="comment">//片段着色器代码</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">char</span>* fragment_shader_text =</span><br><span class="line">        <span class="string">&quot;#version 110\n&quot;</span></span><br><span class="line">        <span class="string">&quot;varying vec4 v_color;\n&quot;</span></span><br><span class="line">        <span class="string">&quot;void main()\n&quot;</span></span><br><span class="line">        <span class="string">&quot;&#123;\n&quot;</span></span><br><span class="line">        <span class="string">&quot;    gl_FragColor = v_color;\n&quot;</span></span><br><span class="line">        <span class="string">&quot;&#125;\n&quot;</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">//UNTITLED_SHADERSOURCE_H</span></span></span><br></pre></td></tr></table></figure><p>看完之后,我大致的理解就是下图:</p><p><img src="https://s21.ax1x.com/2024/06/24/pksSAeS.png" alt="着色器绘制图形的基本过程"></p><p>Shader本质上来说就是运行在GPU上面的程序</p><blockquote><p>目前市面上的手机，很大一部分仍然是OpenGL ES3.0的版本或更低。</p><p>Computer Shader在OpenGL ES 3.1版本才开始支持。</p><p>Geometry Shader在OpenGL ES 3.2版本才开始支持。</p></blockquote><h3 id="2-顶点着色器"><a href="#2-顶点着色器" class="headerlink" title="2&#x2F;顶点着色器"></a>2&#x2F;顶点着色器</h3><blockquote><p>顶点着色器的功能就是：<code>对输入的顶点坐标进行处理，然后再输出。</code></p></blockquote><h4 id="版本限定"><a href="#版本限定" class="headerlink" title="版本限定"></a>版本限定</h4><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 110</span></span><br></pre></td></tr></table></figure><p>每个Shader开头的语句,就是版本限定,也就是说如果你的设备不支持这个版本,那么这个Shader将直接被跳过</p><h4 id="统一变量与属性变量以及输出变量"><a href="#统一变量与属性变量以及输出变量" class="headerlink" title="统一变量与属性变量以及输出变量"></a>统一变量与属性变量以及输出变量</h4><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> u_MVPMatrix;</span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec3</span> a_pos;</span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec4</span> a_color;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> v_color;</span><br></pre></td></tr></table></figure><p>由于Shader是运行在GPU上的程序,而GPU是并行运算的.二者的区别就在于一组顶点如果分摊到GPU的逻辑单元,如果每个逻辑单元处理的是相同的数据,那么就称之为统一变量,反之就是属性变量</p><p>变量的修饰有点类似于OOP中的public与private</p><p>attribute所修饰的属性变量每执行一次Shader就需要被重新赋值</p><blockquote><p>输出变量由varying关键字修饰，用于从顶点着色器，传递数据到片段着色器。</p><p>每个Shader都有入口函数 main()，顶点Shader主要工作就是：计算坐标。</p><p>得到坐标计算结果后，传给内置变量 gl_Position。</p><p>GPU拿到gl_Position，执行裁剪。</p></blockquote><h3 id="3-片段着色器"><a href="#3-片段着色器" class="headerlink" title="3&#x2F;片段着色器"></a>3&#x2F;片段着色器</h3><blockquote><p>片段着色器(像素着色器)的功能就是：输出颜色。</p><p>片段着色器(像素着色器)也是并行的，不过执行的次数不是顶点个数，而是屏幕像素个数。</p><p>举例绘制一个960x540的长方形，每一个像素点的颜色，都是通过执行一次片段着色器来得到，那么GPU需要执行960x540次。</p></blockquote><p>顶点着色器的输出变量,就是片段着色器的输入变量</p><blockquote><p>片段着色器一般都是输出到<code>gl_FragColor</code>这个内置变量。<br>所有从顶点着色器输出到片段着色器的数据，都会插值！</p></blockquote><h3 id="4-UV"><a href="#4-UV" class="headerlink" title="4&#x2F;UV"></a>4&#x2F;UV</h3><blockquote><p>UV坐标指的是顶点对应在图片的哪个位置</p></blockquote><p>UV的坐标范围是[0f, 1f],UV映射就是顶点坐标和贴图对应起来的操作.</p><p>贴图文件大致分为三种:</p><ul><li>没有压缩的图片格式 bmp</li><li>CPU压缩的图片格式 无损压缩:png,有损压缩:jpg</li><li>显卡支持的图片格式</li></ul><p>贴图的显示方式差不多就是下面这样:</p><p><img src="https://s21.ax1x.com/2024/06/24/pks9pKP.png" alt="贴图的渲染过程"></p><h3 id="5-杂项笔记"><a href="#5-杂项笔记" class="headerlink" title="5&#x2F;杂项笔记"></a>5&#x2F;杂项笔记</h3><p>在GPU上创建对象，都是分三步，调用3个API：</p><ul><li><code>glGenxxxx</code> 在GPU上进行创建xx对象</li><li><code>glBindxxx</code> 将xx对象指定为类型</li><li><code>glxxxxxxx</code> 上传数据</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;0-openGL环境搭建&quot;&gt;&lt;a href=&quot;#0-openGL环境搭建&quot; class=&quot;headerlink&quot; title=&quot;0&amp;#x2F;openGL环境搭建&quot;&gt;&lt;/a&gt;0&amp;#x2F;openGL环境搭建&lt;/h3&gt;&lt;p&gt;在【从0开始手搓游戏引擎】系列里面，图形</summary>
      
    
    
    
    <category term="浅入浅出游戏引擎" scheme="https://mralridge.github.io/categories/%E6%B5%85%E5%85%A5%E6%B5%85%E5%87%BA%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E/"/>
    
    
    <category term="c++" scheme="https://mralridge.github.io/tags/c/"/>
    
    <category term="游戏引擎" scheme="https://mralridge.github.io/tags/%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E/"/>
    
    <category term="浅入浅出" scheme="https://mralridge.github.io/tags/%E6%B5%85%E5%85%A5%E6%B5%85%E5%87%BA/"/>
    
  </entry>
  
</feed>
